nohup: ignoring input
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 9 e 0 | val loss 2.3023 val acc 11.3231 best val_acc 11.323052
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 10 e 25 | val loss 2.1978 val acc 20.0487 best val_acc 20.758929
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 10 e 50 | val loss 2.2805 val acc 11.4245 best val_acc 20.758929
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 9 e 75 | val loss 2.2865 val acc 13.0479 best val_acc 20.758929
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 10 e 100 | val loss 2.1712 val acc 18.4456 best val_acc 21.408279
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 7 e 125 | val loss 2.1928 val acc 15.5844 best val_acc 21.408279
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 9 e 150 | val loss 2.2986 val acc 11.8101 best val_acc 23.660714
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 9 e 175 | val loss 2.2670 val acc 13.7987 best val_acc 23.660714
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 10 e 200 | val loss 2.3153 val acc 9.7403 best val_acc 23.660714
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 10 e 225 | val loss 2.3135 val acc 9.7403 best val_acc 23.660714
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 7 e 250 | val loss 2.3026 val acc 9.7403 best val_acc 23.660714
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 275 | val loss 2.2846 val acc 15.5235 best val_acc 23.660714
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 6 e 300 | val loss 2.1660 val acc 15.1989 best val_acc 23.660714
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 4 e 325 | val loss 2.2573 val acc 13.2711 best val_acc 23.660714
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 4 e 350 | val loss 2.2187 val acc 13.4740 best val_acc 23.660714
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 9 e 375 | val loss 1.9294 val acc 23.1534 best val_acc 23.660714
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 400 | val loss 2.0720 val acc 19.2370 best val_acc 23.660714
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 10 e 425 | val loss 2.0476 val acc 19.2776 best val_acc 23.660714
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 7 e 450 | val loss 2.0958 val acc 18.1818 best val_acc 23.660714
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 4 e 475 | val loss 2.0432 val acc 17.5122 best val_acc 23.660714
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 10 e 500 | val loss 1.8829 val acc 26.8466 best val_acc 26.846591
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 3 e 525 | val loss 2.1577 val acc 19.1153 best val_acc 27.414773
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 2 e 550 | val loss 2.2343 val acc 11.8506 best val_acc 28.551136
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 4 e 575 | val loss 2.0920 val acc 19.4399 best val_acc 28.652597
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 3 e 600 | val loss 2.1445 val acc 22.5649 best val_acc 28.794643
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 6 e 625 | val loss 1.8949 val acc 24.6753 best val_acc 29.403409
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 8 e 650 | val loss 2.0810 val acc 19.3385 best val_acc 31.797890
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 10 e 675 | val loss 1.9559 val acc 24.8377 best val_acc 31.797890
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 3 e 700 | val loss 1.9176 val acc 28.7946 best val_acc 31.797890
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 10 e 725 | val loss 1.9237 val acc 25.6494 best val_acc 31.797890
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 10 e 750 | val loss 1.9652 val acc 25.2029 best val_acc 31.797890
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 9 e 775 | val loss 1.8482 val acc 29.5455 best val_acc 33.299513
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 5 e 800 | val loss 1.9813 val acc 21.4692 best val_acc 34.273539
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 10 e 825 | val loss 1.9023 val acc 24.2086 best val_acc 34.273539
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 9 e 850 | val loss 1.9307 val acc 25.5479 best val_acc 34.273539
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 6 e 875 | val loss 1.9506 val acc 25.8523 best val_acc 34.273539
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 5 e 900 | val loss 2.1489 val acc 19.6631 best val_acc 34.963474
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 6 e 925 | val loss 2.2763 val acc 15.0974 best val_acc 34.963474
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 4 e 950 | val loss 1.9572 val acc 27.0698 best val_acc 34.963474
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 10 e 975 | val loss 1.9596 val acc 26.0755 best val_acc 34.963474
New learnin rate  0.25
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 6 e 1000 | val loss 1.9008 val acc 29.4643 best val_acc 35.957792
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 10 e 1025 | val loss 1.7559 val acc 32.5081 best val_acc 39.042208
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 3 e 1050 | val loss 2.0106 val acc 29.4846 best val_acc 40.036526
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 5 e 1075 | val loss 1.6991 val acc 36.3433 best val_acc 40.036526
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 6 e 1100 | val loss 1.8043 val acc 33.8677 best val_acc 40.645292
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 6 e 1125 | val loss 1.7576 val acc 33.0966 best val_acc 41.781656
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 6 e 1150 | val loss 1.7320 val acc 32.8734 best val_acc 41.781656
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 7 e 1175 | val loss 1.6227 val acc 40.1177 best val_acc 41.781656
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 10 e 1199 | val loss 1.6906 val acc 37.0536 best val_acc 42.146916
Multi_krum: at our_attack_cos_second n_at 10 n_mal_sel 6 e 1200 | val loss 1.6278 val acc 40.2597 best val_acc 42.146916
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 0 | val loss 2.3024 val acc 9.7606 best val_acc 9.760552
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 25 | val loss 2.3031 val acc 9.9229 best val_acc 17.735390
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 50 | val loss 2.2318 val acc 10.5114 best val_acc 20.515422
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 75 | val loss 2.2893 val acc 16.3961 best val_acc 20.515422
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 100 | val loss 2.2968 val acc 12.3580 best val_acc 20.515422
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 125 | val loss 2.3355 val acc 9.7403 best val_acc 20.535714
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 150 | val loss 2.3043 val acc 10.1664 best val_acc 20.535714
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 175 | val loss 2.2019 val acc 16.5381 best val_acc 20.535714
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 200 | val loss 2.3190 val acc 10.3490 best val_acc 21.327110
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 225 | val loss 2.1337 val acc 16.4976 best val_acc 21.327110
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 250 | val loss 2.1053 val acc 18.5268 best val_acc 21.327110
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 275 | val loss 2.0726 val acc 19.4399 best val_acc 21.895292
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 300 | val loss 2.3132 val acc 9.7200 best val_acc 22.422890
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 325 | val loss 2.2022 val acc 17.0252 best val_acc 22.422890
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 350 | val loss 2.1144 val acc 20.6778 best val_acc 23.904221
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 375 | val loss 2.0890 val acc 18.0804 best val_acc 23.904221
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 400 | val loss 2.1111 val acc 18.9935 best val_acc 24.066558
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 425 | val loss 2.2276 val acc 21.2459 best val_acc 24.634740
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 450 | val loss 2.0060 val acc 23.4375 best val_acc 24.634740
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 475 | val loss 2.0709 val acc 17.6339 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 500 | val loss 2.4568 val acc 9.4968 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 525 | val loss 2.2926 val acc 12.4188 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 550 | val loss 2.0639 val acc 19.1964 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 575 | val loss 2.3723 val acc 10.4302 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 600 | val loss 2.0391 val acc 19.4196 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 625 | val loss 2.3392 val acc 11.2216 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 650 | val loss 2.3765 val acc 17.1672 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 675 | val loss 2.4158 val acc 9.6997 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 700 | val loss 2.3113 val acc 9.7403 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 725 | val loss 2.3034 val acc 10.5317 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 750 | val loss 2.3185 val acc 9.7606 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 775 | val loss 2.2211 val acc 14.9148 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 800 | val loss 2.8579 val acc 12.1347 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 825 | val loss 2.3030 val acc 9.6185 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 850 | val loss 2.3030 val acc 9.6185 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 875 | val loss 2.3031 val acc 10.2881 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 900 | val loss 2.3031 val acc 9.6185 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 925 | val loss 2.3028 val acc 9.6185 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 950 | val loss 2.3030 val acc 9.6185 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 975 | val loss 2.3031 val acc 10.2881 best val_acc 25.365260
New learnin rate  0.25
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 1000 | val loss 2.3031 val acc 10.2881 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 1025 | val loss 2.3029 val acc 10.2881 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 1050 | val loss 2.3030 val acc 9.6185 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 1075 | val loss 2.3031 val acc 10.2881 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 1100 | val loss 2.3031 val acc 9.6185 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 1125 | val loss 2.3029 val acc 9.6185 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 1150 | val loss 2.3030 val acc 9.6185 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 1175 | val loss 2.3031 val acc 10.2881 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 0 e 1199 | val loss 2.3031 val acc 10.2881 best val_acc 25.365260
krum: at our_attack_cos_second n_at 10 n_mal_sel 1 e 1200 | val loss 2.3031 val acc 9.6185 best val_acc 25.365260
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Bulyan: at our_attack_cos_second n_at 10 n_mal_sel 9 e 0 | val loss 2.3023 val acc 11.7898 best val_acc 11.789773
Bulyan: at our_attack_cos_second n_at 10 n_mal_sel 9 e 25 | val loss 2.2921 val acc 11.6477 best val_acc 19.237013
Bulyan: at our_attack_cos_second n_at 10 n_mal_sel 9 e 50 | val loss 2.2538 val acc 11.0795 best val_acc 19.845779
val loss 442092.313312 too high
change new seed now epoch: 67
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Median: at our_attack_cos_second n_at 10  e 0 | val loss 2.3023 val acc 11.7289 best val_acc 11.728896
Median: at our_attack_cos_second n_at 10  e 25 | val loss 2.3008 val acc 9.7403 best val_acc 20.008117
Median: at our_attack_cos_second n_at 10  e 50 | val loss 2.2263 val acc 17.0657 best val_acc 20.008117
Median: at our_attack_cos_second n_at 10  e 75 | val loss 2.3070 val acc 10.1461 best val_acc 21.509740
Median: at our_attack_cos_second n_at 10  e 100 | val loss 2.2207 val acc 16.0511 best val_acc 21.509740
Median: at our_attack_cos_second n_at 10  e 125 | val loss 2.1752 val acc 17.1063 best val_acc 21.509740
Median: at our_attack_cos_second n_at 10  e 150 | val loss 2.2625 val acc 10.7752 best val_acc 21.509740
Median: at our_attack_cos_second n_at 10  e 175 | val loss 2.1978 val acc 14.6713 best val_acc 21.509740
Median: at our_attack_cos_second n_at 10  e 200 | val loss 2.2136 val acc 13.6972 best val_acc 22.159091
Median: at our_attack_cos_second n_at 10  e 225 | val loss 2.3308 val acc 11.2622 best val_acc 23.214286
Median: at our_attack_cos_second n_at 10  e 250 | val loss 2.1801 val acc 23.4578 best val_acc 23.741883
Median: at our_attack_cos_second n_at 10  e 275 | val loss 2.1760 val acc 19.9269 best val_acc 23.741883
Median: at our_attack_cos_second n_at 10  e 300 | val loss 2.1773 val acc 14.9351 best val_acc 23.741883
Median: at our_attack_cos_second n_at 10  e 325 | val loss 2.1605 val acc 17.2078 best val_acc 23.782468
Median: at our_attack_cos_second n_at 10  e 350 | val loss 2.0358 val acc 23.4781 best val_acc 26.197240
Median: at our_attack_cos_second n_at 10  e 375 | val loss 2.2125 val acc 20.3531 best val_acc 28.672890
Median: at our_attack_cos_second n_at 10  e 400 | val loss 2.0561 val acc 20.2719 best val_acc 28.672890
Median: at our_attack_cos_second n_at 10  e 425 | val loss 1.9767 val acc 25.8929 best val_acc 28.672890
Median: at our_attack_cos_second n_at 10  e 450 | val loss 2.0108 val acc 25.2638 best val_acc 28.672890
Median: at our_attack_cos_second n_at 10  e 475 | val loss 2.3022 val acc 19.0950 best val_acc 28.814935
Median: at our_attack_cos_second n_at 10  e 500 | val loss 2.1576 val acc 17.7760 best val_acc 28.814935
Median: at our_attack_cos_second n_at 10  e 525 | val loss 1.9676 val acc 23.7216 best val_acc 28.814935
Median: at our_attack_cos_second n_at 10  e 550 | val loss 1.9537 val acc 27.3336 best val_acc 28.814935
Median: at our_attack_cos_second n_at 10  e 575 | val loss 2.0058 val acc 26.9683 best val_acc 28.814935
Median: at our_attack_cos_second n_at 10  e 600 | val loss 1.9815 val acc 25.0203 best val_acc 32.650162
Median: at our_attack_cos_second n_at 10  e 625 | val loss 2.3815 val acc 10.3287 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 650 | val loss 2.3680 val acc 10.3490 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 675 | val loss 2.2802 val acc 12.1347 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 700 | val loss 2.1890 val acc 18.2630 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 725 | val loss 2.2324 val acc 15.1177 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 750 | val loss 2.0508 val acc 23.0925 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 775 | val loss 2.3859 val acc 10.2070 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 800 | val loss 2.5009 val acc 11.5666 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 825 | val loss 2.2393 val acc 16.2338 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 850 | val loss 2.2544 val acc 12.7638 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 875 | val loss 2.3243 val acc 9.5982 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 900 | val loss 2.2888 val acc 12.1753 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 925 | val loss 2.3017 val acc 9.6388 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 950 | val loss 2.2752 val acc 12.4594 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 975 | val loss 2.3034 val acc 9.5982 best val_acc 33.340097
New learnin rate  0.25
Median: at our_attack_cos_second n_at 10  e 1000 | val loss 2.3030 val acc 9.7606 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 1025 | val loss 2.3030 val acc 9.7606 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 1050 | val loss 2.3030 val acc 9.7606 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 1075 | val loss 2.3030 val acc 9.7606 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 1100 | val loss 2.3031 val acc 9.7606 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 1125 | val loss 2.3031 val acc 9.7606 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 1150 | val loss 2.3031 val acc 9.7606 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 1175 | val loss 2.3031 val acc 9.7606 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 1199 | val loss 2.3031 val acc 9.7606 best val_acc 33.340097
Median: at our_attack_cos_second n_at 10  e 1200 | val loss 2.3031 val acc 9.7606 best val_acc 33.340097
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
tr_mean: at our_attack_cos_second n_at 10  e 0 | val loss 2.3023 val acc 11.5666 best val_acc 11.566558
tr_mean: at our_attack_cos_second n_at 10  e 25 | val loss 2.2413 val acc 12.7435 best val_acc 20.779221
tr_mean: at our_attack_cos_second n_at 10  e 50 | val loss 2.3046 val acc 9.6185 best val_acc 20.860390
tr_mean: at our_attack_cos_second n_at 10  e 75 | val loss 2.2941 val acc 13.0073 best val_acc 20.860390
tr_mean: at our_attack_cos_second n_at 10  e 100 | val loss 2.1166 val acc 17.4310 best val_acc 20.860390
tr_mean: at our_attack_cos_second n_at 10  e 125 | val loss 2.3025 val acc 10.2476 best val_acc 20.860390
tr_mean: at our_attack_cos_second n_at 10  e 150 | val loss 2.3010 val acc 11.3433 best val_acc 20.860390
tr_mean: at our_attack_cos_second n_at 10  e 175 | val loss 2.2745 val acc 14.7119 best val_acc 20.860390
tr_mean: at our_attack_cos_second n_at 10  e 200 | val loss 2.3088 val acc 10.0041 best val_acc 20.860390
tr_mean: at our_attack_cos_second n_at 10  e 225 | val loss 2.1612 val acc 16.4976 best val_acc 20.860390
tr_mean: at our_attack_cos_second n_at 10  e 250 | val loss 2.1548 val acc 17.1875 best val_acc 20.860390
tr_mean: at our_attack_cos_second n_at 10  e 275 | val loss 2.0938 val acc 18.8515 best val_acc 20.860390
tr_mean: at our_attack_cos_second n_at 10  e 300 | val loss 2.2999 val acc 9.6794 best val_acc 20.860390
tr_mean: at our_attack_cos_second n_at 10  e 325 | val loss 2.1731 val acc 17.0252 best val_acc 23.295455
tr_mean: at our_attack_cos_second n_at 10  e 350 | val loss 2.4421 val acc 12.8044 best val_acc 25.365260
tr_mean: at our_attack_cos_second n_at 10  e 375 | val loss 2.1526 val acc 17.3904 best val_acc 25.365260
tr_mean: at our_attack_cos_second n_at 10  e 400 | val loss 1.9739 val acc 22.2200 best val_acc 25.365260
tr_mean: at our_attack_cos_second n_at 10  e 425 | val loss 2.0565 val acc 24.1883 best val_acc 28.409091
tr_mean: at our_attack_cos_second n_at 10  e 450 | val loss 2.1365 val acc 19.3588 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 475 | val loss 2.5729 val acc 19.1558 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 500 | val loss 2.2709 val acc 13.1291 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 525 | val loss 2.3007 val acc 11.3636 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 550 | val loss 2.1990 val acc 17.0657 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 575 | val loss 2.0522 val acc 18.5877 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 600 | val loss 2.0177 val acc 23.2549 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 625 | val loss 2.1369 val acc 20.3328 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 650 | val loss 2.1030 val acc 19.2573 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 675 | val loss 2.0735 val acc 21.6924 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 700 | val loss 2.1446 val acc 19.5414 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 725 | val loss 2.0281 val acc 26.4407 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 750 | val loss 2.1637 val acc 16.9237 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 775 | val loss 2.2348 val acc 20.8198 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 800 | val loss 2.3292 val acc 10.4099 best val_acc 29.809253
tr_mean: at our_attack_cos_second n_at 10  e 825 | val loss 2.2508 val acc 17.5122 best val_acc 29.809253
val loss 1126.092819 too high
change new seed now epoch: 842
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
FedAvg: at our_attack_cos_second n_at 10  e 0 | val loss 2.3023 val acc 11.2622 best val_acc 11.262175
FedAvg: at our_attack_cos_second n_at 10  e 25 | val loss 2.2994 val acc 11.2419 best val_acc 20.840097
FedAvg: at our_attack_cos_second n_at 10  e 50 | val loss 2.2130 val acc 17.3904 best val_acc 20.840097
FedAvg: at our_attack_cos_second n_at 10  e 75 | val loss 2.3266 val acc 9.4765 best val_acc 22.341721
FedAvg: at our_attack_cos_second n_at 10  e 100 | val loss 2.5164 val acc 14.4481 best val_acc 22.341721
FedAvg: at our_attack_cos_second n_at 10  e 125 | val loss 2.3115 val acc 9.9635 best val_acc 22.341721
FedAvg: at our_attack_cos_second n_at 10  e 150 | val loss 2.1922 val acc 17.7760 best val_acc 22.341721
FedAvg: at our_attack_cos_second n_at 10  e 175 | val loss 2.1856 val acc 20.1502 best val_acc 22.483766
FedAvg: at our_attack_cos_second n_at 10  e 200 | val loss 2.1611 val acc 16.4367 best val_acc 24.310065
FedAvg: at our_attack_cos_second n_at 10  e 225 | val loss 2.0618 val acc 20.5560 best val_acc 24.655032
FedAvg: at our_attack_cos_second n_at 10  e 250 | val loss 1.9262 val acc 27.7597 best val_acc 27.759740
FedAvg: at our_attack_cos_second n_at 10  e 275 | val loss 1.9371 val acc 26.3596 best val_acc 28.104708
FedAvg: at our_attack_cos_second n_at 10  e 300 | val loss 1.8979 val acc 27.3133 best val_acc 30.296266
FedAvg: at our_attack_cos_second n_at 10  e 325 | val loss 2.1997 val acc 17.0049 best val_acc 30.296266
FedAvg: at our_attack_cos_second n_at 10  e 350 | val loss 1.9904 val acc 23.2143 best val_acc 30.296266
FedAvg: at our_attack_cos_second n_at 10  e 375 | val loss 1.9442 val acc 26.3393 best val_acc 30.296266
FedAvg: at our_attack_cos_second n_at 10  e 400 | val loss 2.2243 val acc 15.6250 best val_acc 30.296266
FedAvg: at our_attack_cos_second n_at 10  e 425 | val loss 1.9523 val acc 27.9221 best val_acc 30.296266
FedAvg: at our_attack_cos_second n_at 10  e 450 | val loss 2.3913 val acc 16.1932 best val_acc 30.803571
FedAvg: at our_attack_cos_second n_at 10  e 475 | val loss 1.9890 val acc 26.5422 best val_acc 30.803571
FedAvg: at our_attack_cos_second n_at 10  e 500 | val loss 2.1766 val acc 20.8401 best val_acc 30.905032
FedAvg: at our_attack_cos_second n_at 10  e 525 | val loss 2.1981 val acc 20.2516 best val_acc 31.432630
FedAvg: at our_attack_cos_second n_at 10  e 550 | val loss 1.9289 val acc 27.5365 best val_acc 34.090909
FedAvg: at our_attack_cos_second n_at 10  e 575 | val loss 1.9251 val acc 29.4643 best val_acc 34.090909
FedAvg: at our_attack_cos_second n_at 10  e 600 | val loss 1.9458 val acc 26.2784 best val_acc 34.090909
FedAvg: at our_attack_cos_second n_at 10  e 625 | val loss 2.0809 val acc 19.8458 best val_acc 34.090909
FedAvg: at our_attack_cos_second n_at 10  e 650 | val loss 1.9076 val acc 28.7338 best val_acc 34.090909
FedAvg: at our_attack_cos_second n_at 10  e 675 | val loss 2.0250 val acc 27.7800 best val_acc 34.090909
FedAvg: at our_attack_cos_second n_at 10  e 700 | val loss 1.9460 val acc 26.5625 best val_acc 34.090909
FedAvg: at our_attack_cos_second n_at 10  e 725 | val loss 2.3117 val acc 10.2476 best val_acc 34.090909
FedAvg: at our_attack_cos_second n_at 10  e 750 | val loss 1.9146 val acc 29.3019 best val_acc 34.090909
FedAvg: at our_attack_cos_second n_at 10  e 775 | val loss 2.0497 val acc 22.6664 best val_acc 34.090909
FedAvg: at our_attack_cos_second n_at 10  e 800 | val loss 1.9402 val acc 26.1567 best val_acc 34.090909
FedAvg: at our_attack_cos_second n_at 10  e 825 | val loss 1.9108 val acc 29.0381 best val_acc 34.090909
FedAvg: at our_attack_cos_second n_at 10  e 850 | val loss 3.0569 val acc 9.9635 best val_acc 34.090909
val loss 379508061.922078 too high
change new seed now epoch: 855
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Norm_bounding: at our_attack_cos_second n_at 10  e 0 | val loss 2.3023 val acc 11.2216 best val_acc 11.221591
Norm_bounding: at our_attack_cos_second n_at 10  e 25 | val loss 2.3305 val acc 9.7403 best val_acc 21.935877
Norm_bounding: at our_attack_cos_second n_at 10  e 50 | val loss 2.2934 val acc 13.0885 best val_acc 21.935877
Norm_bounding: at our_attack_cos_second n_at 10  e 75 | val loss 2.1974 val acc 20.2719 best val_acc 21.935877
Norm_bounding: at our_attack_cos_second n_at 10  e 100 | val loss 2.1242 val acc 23.2346 best val_acc 23.234578
Norm_bounding: at our_attack_cos_second n_at 10  e 125 | val loss 2.2204 val acc 15.9294 best val_acc 24.634740
Norm_bounding: at our_attack_cos_second n_at 10  e 150 | val loss 2.1208 val acc 20.2922 best val_acc 24.634740
Norm_bounding: at our_attack_cos_second n_at 10  e 175 | val loss 2.1420 val acc 19.0138 best val_acc 25.994318
Norm_bounding: at our_attack_cos_second n_at 10  e 200 | val loss 2.0067 val acc 27.9424 best val_acc 27.942370
Norm_bounding: at our_attack_cos_second n_at 10  e 225 | val loss 1.9368 val acc 27.8003 best val_acc 27.942370
Norm_bounding: at our_attack_cos_second n_at 10  e 250 | val loss 1.8526 val acc 30.0933 best val_acc 30.458604
Norm_bounding: at our_attack_cos_second n_at 10  e 275 | val loss 2.3297 val acc 14.4886 best val_acc 30.945617
Norm_bounding: at our_attack_cos_second n_at 10  e 300 | val loss 2.0307 val acc 27.1307 best val_acc 30.945617
Norm_bounding: at our_attack_cos_second n_at 10  e 325 | val loss 1.8828 val acc 32.5284 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 350 | val loss 2.4161 val acc 10.2476 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 375 | val loss 2.3115 val acc 9.9635 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 400 | val loss 2.3035 val acc 9.9635 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 425 | val loss 2.3028 val acc 9.7606 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 450 | val loss 2.3023 val acc 9.6185 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 475 | val loss 2.3024 val acc 10.7346 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 500 | val loss 2.3028 val acc 9.6185 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 525 | val loss 2.2960 val acc 13.7987 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 550 | val loss 2.2351 val acc 10.6128 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 575 | val loss 2.0128 val acc 22.7679 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 600 | val loss 2.2907 val acc 13.2914 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 625 | val loss 2.3318 val acc 20.1705 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 650 | val loss 2.1397 val acc 27.2727 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 675 | val loss 2.0975 val acc 19.7037 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 700 | val loss 1.9818 val acc 25.4464 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 725 | val loss 1.9606 val acc 26.0349 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 750 | val loss 1.9374 val acc 26.1567 best val_acc 33.705357
Norm_bounding: at our_attack_cos_second n_at 10  e 775 | val loss 4.7996 val acc 20.2922 best val_acc 35.653409
val loss 45397.303927 too high
change new seed now epoch: 778
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 0 | val loss 2.3023 val acc 11.5666 best val_acc 11.566558
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 25 | val loss 2.3002 val acc 10.0244 best val_acc 18.506494
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 50 | val loss 2.2086 val acc 14.5698 best val_acc 19.805195
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 75 | val loss 2.1325 val acc 19.0341 best val_acc 21.367695
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 100 | val loss 1.9778 val acc 23.3969 best val_acc 23.620130
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 125 | val loss 2.0407 val acc 25.9943 best val_acc 28.226461
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 150 | val loss 2.1181 val acc 21.3677 best val_acc 28.226461
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 175 | val loss 2.1501 val acc 18.6891 best val_acc 28.226461
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 200 | val loss 2.1619 val acc 17.1672 best val_acc 28.226461
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 225 | val loss 1.9208 val acc 28.3685 best val_acc 28.368506
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 250 | val loss 1.9220 val acc 24.3506 best val_acc 28.368506
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 275 | val loss 1.9574 val acc 27.2727 best val_acc 32.163149
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 300 | val loss 1.9604 val acc 25.2435 best val_acc 32.163149
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 325 | val loss 2.1431 val acc 18.5471 best val_acc 32.163149
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 350 | val loss 1.7606 val acc 34.3547 best val_acc 34.577922
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 375 | val loss 1.8608 val acc 31.7979 best val_acc 34.577922
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 400 | val loss 1.7941 val acc 32.2240 best val_acc 34.801136
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 425 | val loss 1.7435 val acc 34.5373 best val_acc 36.505682
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 450 | val loss 1.7665 val acc 33.4416 best val_acc 37.439123
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 475 | val loss 2.0393 val acc 28.2468 best val_acc 39.204545
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 500 | val loss 1.7170 val acc 37.5406 best val_acc 39.204545
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 525 | val loss 1.8947 val acc 34.5373 best val_acc 40.969968
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 550 | val loss 2.1898 val acc 18.6282 best val_acc 41.274351
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 575 | val loss 1.8885 val acc 30.3774 best val_acc 41.274351
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 600 | val loss 1.9252 val acc 32.3458 best val_acc 41.274351
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 625 | val loss 1.9458 val acc 27.0901 best val_acc 41.862825
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 650 | val loss 2.5065 val acc 14.2857 best val_acc 42.735390
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 675 | val loss 1.8527 val acc 36.0795 best val_acc 42.735390
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 700 | val loss 1.5840 val acc 41.8222 best val_acc 43.587662
Multi_krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 725 | val loss 1.7106 val acc 36.9318 best val_acc 46.205357
val loss 9003.735104 too high
change new seed now epoch: 740
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 1 e 0 | val loss 2.3023 val acc 11.1810 best val_acc 11.181006
krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 1 e 25 | val loss 2.2878 val acc 13.9205 best val_acc 17.512175
krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 1 e 50 | val loss 2.2040 val acc 18.4862 best val_acc 22.686688
krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 1 e 75 | val loss 2.2915 val acc 13.5755 best val_acc 22.686688
krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 1 e 100 | val loss 2.2687 val acc 16.2135 best val_acc 22.686688
krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 1 e 125 | val loss 2.1947 val acc 15.3003 best val_acc 22.686688
krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 1 e 150 | val loss 2.1685 val acc 18.8920 best val_acc 22.686688
krum: at our_attack_min_eigenvalue n_at 10 n_mal_sel 1 e 175 | val loss 2.4297 val acc 8.3198 best val_acc 22.686688
val loss 424615.738839 too high
change new seed now epoch: 179
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Bulyan: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 0 | val loss 2.3023 val acc 11.0593 best val_acc 11.059253
Bulyan: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 25 | val loss 2.2898 val acc 10.8969 best val_acc 20.271916
Bulyan: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 50 | val loss 2.2808 val acc 14.8945 best val_acc 20.271916
Bulyan: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 75 | val loss 2.2108 val acc 16.9034 best val_acc 20.454545
Bulyan: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 100 | val loss 2.1960 val acc 16.8425 best val_acc 20.454545
Bulyan: at our_attack_min_eigenvalue n_at 10 n_mal_sel 10 e 125 | val loss 2.1382 val acc 19.8864 best val_acc 20.454545
val loss 1177.984601 too high
change new seed now epoch: 132
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Median: at our_attack_min_eigenvalue n_at 10  e 0 | val loss 2.3023 val acc 11.5666 best val_acc 11.566558
Median: at our_attack_min_eigenvalue n_at 10  e 25 | val loss 2.2970 val acc 12.1550 best val_acc 20.332792
Median: at our_attack_min_eigenvalue n_at 10  e 50 | val loss 2.3013 val acc 10.0041 best val_acc 20.332792
Median: at our_attack_min_eigenvalue n_at 10  e 75 | val loss 2.1197 val acc 21.2256 best val_acc 21.956169
Median: at our_attack_min_eigenvalue n_at 10  e 100 | val loss 2.4498 val acc 12.3377 best val_acc 22.057630
Median: at our_attack_min_eigenvalue n_at 10  e 125 | val loss 2.3145 val acc 9.7403 best val_acc 22.057630
Median: at our_attack_min_eigenvalue n_at 10  e 150 | val loss 2.2980 val acc 11.0187 best val_acc 22.747565
Median: at our_attack_min_eigenvalue n_at 10  e 175 | val loss 2.2296 val acc 18.8920 best val_acc 24.715909
Median: at our_attack_min_eigenvalue n_at 10  e 200 | val loss 2.2661 val acc 12.6015 best val_acc 25.426136
Median: at our_attack_min_eigenvalue n_at 10  e 225 | val loss 2.1075 val acc 19.0341 best val_acc 25.426136
Median: at our_attack_min_eigenvalue n_at 10  e 250 | val loss 2.3053 val acc 12.2159 best val_acc 25.426136
Median: at our_attack_min_eigenvalue n_at 10  e 275 | val loss 2.2779 val acc 14.8539 best val_acc 25.426136
Median: at our_attack_min_eigenvalue n_at 10  e 300 | val loss 2.2700 val acc 14.5089 best val_acc 25.426136
Median: at our_attack_min_eigenvalue n_at 10  e 325 | val loss 2.3646 val acc 9.7403 best val_acc 25.426136
Median: at our_attack_min_eigenvalue n_at 10  e 350 | val loss 2.2609 val acc 16.4773 best val_acc 25.426136
Median: at our_attack_min_eigenvalue n_at 10  e 375 | val loss 2.2187 val acc 15.7468 best val_acc 25.426136
Median: at our_attack_min_eigenvalue n_at 10  e 400 | val loss 2.2066 val acc 16.1323 best val_acc 25.426136
Median: at our_attack_min_eigenvalue n_at 10  e 425 | val loss 2.4067 val acc 9.7403 best val_acc 26.582792
Median: at our_attack_min_eigenvalue n_at 10  e 450 | val loss 2.1436 val acc 23.8231 best val_acc 26.582792
Median: at our_attack_min_eigenvalue n_at 10  e 475 | val loss 2.1683 val acc 19.4602 best val_acc 26.582792
Median: at our_attack_min_eigenvalue n_at 10  e 500 | val loss 2.1894 val acc 14.5495 best val_acc 26.582792
Median: at our_attack_min_eigenvalue n_at 10  e 525 | val loss 2.2454 val acc 15.2597 best val_acc 26.582792
Median: at our_attack_min_eigenvalue n_at 10  e 550 | val loss 1.9117 val acc 27.0292 best val_acc 27.232143
Median: at our_attack_min_eigenvalue n_at 10  e 575 | val loss 1.9803 val acc 23.3563 best val_acc 27.232143
Median: at our_attack_min_eigenvalue n_at 10  e 600 | val loss 2.0192 val acc 22.0576 best val_acc 28.348214
Median: at our_attack_min_eigenvalue n_at 10  e 625 | val loss 2.0887 val acc 29.1193 best val_acc 29.870130
Median: at our_attack_min_eigenvalue n_at 10  e 650 | val loss 2.1402 val acc 22.3417 best val_acc 32.244318
Median: at our_attack_min_eigenvalue n_at 10  e 675 | val loss 2.2397 val acc 14.2857 best val_acc 32.244318
Median: at our_attack_min_eigenvalue n_at 10  e 700 | val loss 2.4022 val acc 18.1818 best val_acc 32.244318
Median: at our_attack_min_eigenvalue n_at 10  e 725 | val loss 1.9205 val acc 28.6526 best val_acc 32.244318
Median: at our_attack_min_eigenvalue n_at 10  e 750 | val loss 2.3308 val acc 18.8312 best val_acc 32.244318
Median: at our_attack_min_eigenvalue n_at 10  e 775 | val loss 1.7473 val acc 32.5081 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 800 | val loss 2.0952 val acc 20.7183 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 825 | val loss 2.2211 val acc 18.6688 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 850 | val loss 2.2071 val acc 15.1177 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 875 | val loss 2.2311 val acc 16.4976 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 900 | val loss 2.3411 val acc 9.7403 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 925 | val loss 2.3040 val acc 9.6185 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 950 | val loss 2.3030 val acc 9.6185 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 975 | val loss 2.3028 val acc 9.7403 best val_acc 35.267857
New learnin rate  0.25
Median: at our_attack_min_eigenvalue n_at 10  e 1000 | val loss 2.3027 val acc 10.2881 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 1025 | val loss 2.2989 val acc 9.7606 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 1050 | val loss 2.1699 val acc 17.4310 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 1075 | val loss 2.1806 val acc 17.4919 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 1100 | val loss 2.0673 val acc 19.7443 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 1125 | val loss 2.2543 val acc 13.4740 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 1150 | val loss 2.0957 val acc 19.7646 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 1175 | val loss 1.8822 val acc 29.0990 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 1199 | val loss 1.9354 val acc 27.2727 best val_acc 35.267857
Median: at our_attack_min_eigenvalue n_at 10  e 1200 | val loss 1.9522 val acc 26.0552 best val_acc 35.267857
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
tr_mean: at our_attack_min_eigenvalue n_at 10  e 0 | val loss 2.3023 val acc 11.4042 best val_acc 11.404221
tr_mean: at our_attack_min_eigenvalue n_at 10  e 25 | val loss 2.3058 val acc 9.8011 best val_acc 20.028409
tr_mean: at our_attack_min_eigenvalue n_at 10  e 50 | val loss 2.3096 val acc 10.2476 best val_acc 20.028409
tr_mean: at our_attack_min_eigenvalue n_at 10  e 75 | val loss 2.2817 val acc 12.8247 best val_acc 20.028409
tr_mean: at our_attack_min_eigenvalue n_at 10  e 100 | val loss 2.2725 val acc 15.5438 best val_acc 20.028409
tr_mean: at our_attack_min_eigenvalue n_at 10  e 125 | val loss 2.1554 val acc 18.5268 best val_acc 20.028409
tr_mean: at our_attack_min_eigenvalue n_at 10  e 150 | val loss 2.3340 val acc 10.4302 best val_acc 23.985390
tr_mean: at our_attack_min_eigenvalue n_at 10  e 175 | val loss 2.0652 val acc 21.0430 best val_acc 23.985390
tr_mean: at our_attack_min_eigenvalue n_at 10  e 200 | val loss 1.9255 val acc 25.4870 best val_acc 25.487013
tr_mean: at our_attack_min_eigenvalue n_at 10  e 225 | val loss 2.2024 val acc 16.4773 best val_acc 25.487013
tr_mean: at our_attack_min_eigenvalue n_at 10  e 250 | val loss 2.4048 val acc 16.8628 best val_acc 28.571429
tr_mean: at our_attack_min_eigenvalue n_at 10  e 275 | val loss 1.9575 val acc 25.8726 best val_acc 28.571429
tr_mean: at our_attack_min_eigenvalue n_at 10  e 300 | val loss 2.0043 val acc 29.7687 best val_acc 30.722403
tr_mean: at our_attack_min_eigenvalue n_at 10  e 325 | val loss 2.0230 val acc 26.1769 best val_acc 34.232955
tr_mean: at our_attack_min_eigenvalue n_at 10  e 350 | val loss 1.8677 val acc 30.2963 best val_acc 35.288149
tr_mean: at our_attack_min_eigenvalue n_at 10  e 375 | val loss 1.8426 val acc 31.7979 best val_acc 35.288149
tr_mean: at our_attack_min_eigenvalue n_at 10  e 400 | val loss 1.8618 val acc 30.5195 best val_acc 36.708604
tr_mean: at our_attack_min_eigenvalue n_at 10  e 425 | val loss 1.7051 val acc 37.4188 best val_acc 37.418831
tr_mean: at our_attack_min_eigenvalue n_at 10  e 450 | val loss 2.0460 val acc 24.5536 best val_acc 37.418831
tr_mean: at our_attack_min_eigenvalue n_at 10  e 475 | val loss 2.0590 val acc 24.6347 best val_acc 41.172890
tr_mean: at our_attack_min_eigenvalue n_at 10  e 500 | val loss 1.7125 val acc 35.3896 best val_acc 41.172890
tr_mean: at our_attack_min_eigenvalue n_at 10  e 525 | val loss 2.2312 val acc 14.8945 best val_acc 41.172890
tr_mean: at our_attack_min_eigenvalue n_at 10  e 550 | val loss 1.8643 val acc 30.1745 best val_acc 41.172890
tr_mean: at our_attack_min_eigenvalue n_at 10  e 575 | val loss 1.7704 val acc 33.3807 best val_acc 41.172890
tr_mean: at our_attack_min_eigenvalue n_at 10  e 600 | val loss 1.6684 val acc 40.1177 best val_acc 41.172890
tr_mean: at our_attack_min_eigenvalue n_at 10  e 625 | val loss 1.8090 val acc 35.4911 best val_acc 41.172890
tr_mean: at our_attack_min_eigenvalue n_at 10  e 650 | val loss 1.9560 val acc 25.7914 best val_acc 42.248377
tr_mean: at our_attack_min_eigenvalue n_at 10  e 675 | val loss 1.6256 val acc 41.6193 best val_acc 44.541396
tr_mean: at our_attack_min_eigenvalue n_at 10  e 700 | val loss 1.9262 val acc 27.8612 best val_acc 44.541396
tr_mean: at our_attack_min_eigenvalue n_at 10  e 725 | val loss 1.7602 val acc 34.3141 best val_acc 44.541396
tr_mean: at our_attack_min_eigenvalue n_at 10  e 750 | val loss 2.0354 val acc 25.3653 best val_acc 44.541396
tr_mean: at our_attack_min_eigenvalue n_at 10  e 775 | val loss 1.7231 val acc 37.2971 best val_acc 44.541396
tr_mean: at our_attack_min_eigenvalue n_at 10  e 800 | val loss 1.7112 val acc 38.9407 best val_acc 45.332792
tr_mean: at our_attack_min_eigenvalue n_at 10  e 825 | val loss 1.7282 val acc 38.2508 best val_acc 48.193994
tr_mean: at our_attack_min_eigenvalue n_at 10  e 850 | val loss 1.5170 val acc 45.2516 best val_acc 48.193994
tr_mean: at our_attack_min_eigenvalue n_at 10  e 875 | val loss 1.5315 val acc 44.7849 best val_acc 48.193994
tr_mean: at our_attack_min_eigenvalue n_at 10  e 900 | val loss 1.7023 val acc 40.2800 best val_acc 48.193994
tr_mean: at our_attack_min_eigenvalue n_at 10  e 925 | val loss 1.4796 val acc 47.8693 best val_acc 48.193994
tr_mean: at our_attack_min_eigenvalue n_at 10  e 950 | val loss 1.6062 val acc 43.3442 best val_acc 48.193994
tr_mean: at our_attack_min_eigenvalue n_at 10  e 975 | val loss 1.8682 val acc 37.3985 best val_acc 48.193994
New learnin rate  0.25
tr_mean: at our_attack_min_eigenvalue n_at 10  e 1000 | val loss 1.4674 val acc 45.6981 best val_acc 49.086851
tr_mean: at our_attack_min_eigenvalue n_at 10  e 1025 | val loss 1.4017 val acc 50.0406 best val_acc 53.084416
tr_mean: at our_attack_min_eigenvalue n_at 10  e 1050 | val loss 1.3115 val acc 52.5162 best val_acc 54.200487
tr_mean: at our_attack_min_eigenvalue n_at 10  e 1075 | val loss 1.4339 val acc 48.7825 best val_acc 54.200487
tr_mean: at our_attack_min_eigenvalue n_at 10  e 1100 | val loss 1.8032 val acc 32.9140 best val_acc 54.200487
tr_mean: at our_attack_min_eigenvalue n_at 10  e 1125 | val loss 1.4687 val acc 49.3709 best val_acc 54.200487
tr_mean: at our_attack_min_eigenvalue n_at 10  e 1150 | val loss 1.3779 val acc 50.9131 best val_acc 54.200487
tr_mean: at our_attack_min_eigenvalue n_at 10  e 1175 | val loss 1.4567 val acc 50.2435 best val_acc 54.728084
tr_mean: at our_attack_min_eigenvalue n_at 10  e 1199 | val loss 1.6149 val acc 41.6193 best val_acc 54.728084
tr_mean: at our_attack_min_eigenvalue n_at 10  e 1200 | val loss 1.6185 val acc 46.8750 best val_acc 54.728084
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
FedAvg: at our_attack_min_eigenvalue n_at 10  e 0 | val loss 2.3023 val acc 11.3636 best val_acc 11.363636
FedAvg: at our_attack_min_eigenvalue n_at 10  e 25 | val loss 2.3043 val acc 9.7808 best val_acc 18.973214
FedAvg: at our_attack_min_eigenvalue n_at 10  e 50 | val loss 2.3097 val acc 10.2273 best val_acc 20.413961
FedAvg: at our_attack_min_eigenvalue n_at 10  e 75 | val loss 2.3033 val acc 10.5722 best val_acc 20.413961
FedAvg: at our_attack_min_eigenvalue n_at 10  e 100 | val loss 2.2237 val acc 15.7265 best val_acc 23.498377
FedAvg: at our_attack_min_eigenvalue n_at 10  e 125 | val loss 2.1454 val acc 18.0804 best val_acc 23.498377
FedAvg: at our_attack_min_eigenvalue n_at 10  e 150 | val loss 2.3239 val acc 10.3896 best val_acc 23.681006
FedAvg: at our_attack_min_eigenvalue n_at 10  e 175 | val loss 2.0535 val acc 21.5503 best val_acc 23.681006
FedAvg: at our_attack_min_eigenvalue n_at 10  e 200 | val loss 2.2709 val acc 18.0804 best val_acc 28.145292
FedAvg: at our_attack_min_eigenvalue n_at 10  e 225 | val loss 2.0468 val acc 21.9156 best val_acc 28.145292
FedAvg: at our_attack_min_eigenvalue n_at 10  e 250 | val loss 1.9678 val acc 30.1136 best val_acc 30.113636
FedAvg: at our_attack_min_eigenvalue n_at 10  e 275 | val loss 1.8341 val acc 30.7427 best val_acc 31.818182
FedAvg: at our_attack_min_eigenvalue n_at 10  e 300 | val loss 1.9654 val acc 25.0812 best val_acc 31.818182
FedAvg: at our_attack_min_eigenvalue n_at 10  e 325 | val loss 1.9953 val acc 21.8953 best val_acc 32.000812
FedAvg: at our_attack_min_eigenvalue n_at 10  e 350 | val loss 1.8420 val acc 29.0990 best val_acc 32.000812
FedAvg: at our_attack_min_eigenvalue n_at 10  e 375 | val loss 2.1016 val acc 28.1250 best val_acc 33.543019
FedAvg: at our_attack_min_eigenvalue n_at 10  e 400 | val loss 1.9994 val acc 29.7484 best val_acc 39.184253
FedAvg: at our_attack_min_eigenvalue n_at 10  e 425 | val loss 1.8520 val acc 32.8734 best val_acc 39.184253
FedAvg: at our_attack_min_eigenvalue n_at 10  e 450 | val loss 1.9417 val acc 30.3774 best val_acc 40.259740
FedAvg: at our_attack_min_eigenvalue n_at 10  e 475 | val loss 1.7792 val acc 36.1607 best val_acc 40.259740
FedAvg: at our_attack_min_eigenvalue n_at 10  e 500 | val loss 1.5911 val acc 41.9643 best val_acc 41.964286
FedAvg: at our_attack_min_eigenvalue n_at 10  e 525 | val loss 1.6391 val acc 41.2135 best val_acc 41.964286
FedAvg: at our_attack_min_eigenvalue n_at 10  e 550 | val loss 2.8940 val acc 19.8255 best val_acc 43.709416
FedAvg: at our_attack_min_eigenvalue n_at 10  e 575 | val loss 1.7565 val acc 32.9140 best val_acc 43.709416
FedAvg: at our_attack_min_eigenvalue n_at 10  e 600 | val loss 1.7360 val acc 36.9927 best val_acc 43.709416
FedAvg: at our_attack_min_eigenvalue n_at 10  e 625 | val loss 1.8290 val acc 34.7808 best val_acc 44.845779
FedAvg: at our_attack_min_eigenvalue n_at 10  e 650 | val loss 1.8395 val acc 33.7459 best val_acc 46.185065
FedAvg: at our_attack_min_eigenvalue n_at 10  e 675 | val loss 1.6864 val acc 40.8076 best val_acc 47.017045
FedAvg: at our_attack_min_eigenvalue n_at 10  e 700 | val loss 1.5960 val acc 43.6282 best val_acc 48.823052
FedAvg: at our_attack_min_eigenvalue n_at 10  e 725 | val loss 1.6243 val acc 40.3206 best val_acc 48.823052
FedAvg: at our_attack_min_eigenvalue n_at 10  e 750 | val loss 1.6752 val acc 41.8222 best val_acc 48.823052
FedAvg: at our_attack_min_eigenvalue n_at 10  e 775 | val loss 1.4402 val acc 47.6055 best val_acc 49.715909
FedAvg: at our_attack_min_eigenvalue n_at 10  e 800 | val loss 2.3535 val acc 11.8304 best val_acc 51.339286
FedAvg: at our_attack_min_eigenvalue n_at 10  e 825 | val loss 2.1224 val acc 17.1266 best val_acc 51.339286
FedAvg: at our_attack_min_eigenvalue n_at 10  e 850 | val loss 1.8259 val acc 32.8734 best val_acc 51.339286
FedAvg: at our_attack_min_eigenvalue n_at 10  e 875 | val loss 1.7305 val acc 37.1144 best val_acc 51.339286
FedAvg: at our_attack_min_eigenvalue n_at 10  e 900 | val loss 1.7827 val acc 36.5666 best val_acc 51.339286
FedAvg: at our_attack_min_eigenvalue n_at 10  e 925 | val loss 1.8169 val acc 36.1201 best val_acc 51.339286
FedAvg: at our_attack_min_eigenvalue n_at 10  e 950 | val loss 1.4619 val acc 48.6607 best val_acc 51.339286
FedAvg: at our_attack_min_eigenvalue n_at 10  e 975 | val loss 1.5410 val acc 46.9156 best val_acc 51.339286
New learnin rate  0.25
FedAvg: at our_attack_min_eigenvalue n_at 10  e 1000 | val loss 1.3602 val acc 50.8523 best val_acc 51.806006
FedAvg: at our_attack_min_eigenvalue n_at 10  e 1025 | val loss 1.2901 val acc 54.6266 best val_acc 55.620942
FedAvg: at our_attack_min_eigenvalue n_at 10  e 1050 | val loss 1.3169 val acc 52.7800 best val_acc 55.620942
FedAvg: at our_attack_min_eigenvalue n_at 10  e 1075 | val loss 1.2966 val acc 53.6729 best val_acc 55.620942
FedAvg: at our_attack_min_eigenvalue n_at 10  e 1100 | val loss 1.2502 val acc 55.3166 best val_acc 56.432630
FedAvg: at our_attack_min_eigenvalue n_at 10  e 1125 | val loss 1.3295 val acc 53.5714 best val_acc 57.163149
FedAvg: at our_attack_min_eigenvalue n_at 10  e 1150 | val loss 1.3392 val acc 53.2062 best val_acc 57.873377
FedAvg: at our_attack_min_eigenvalue n_at 10  e 1175 | val loss 1.2981 val acc 54.2005 best val_acc 57.873377
FedAvg: at our_attack_min_eigenvalue n_at 10  e 1199 | val loss 1.4647 val acc 49.9188 best val_acc 57.873377
FedAvg: at our_attack_min_eigenvalue n_at 10  e 1200 | val loss 1.4920 val acc 49.4927 best val_acc 57.873377
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 0 | val loss 2.3023 val acc 11.3231 best val_acc 11.323052
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 25 | val loss 2.3069 val acc 9.9026 best val_acc 22.077922
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 50 | val loss 2.3105 val acc 9.9635 best val_acc 22.118506
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 75 | val loss 2.1445 val acc 16.7411 best val_acc 22.118506
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 100 | val loss 2.2322 val acc 15.8482 best val_acc 22.808442
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 125 | val loss 2.2046 val acc 14.4481 best val_acc 23.315747
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 150 | val loss 2.2441 val acc 10.3490 best val_acc 26.521916
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 175 | val loss 2.2559 val acc 12.0536 best val_acc 26.866883
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 200 | val loss 2.1035 val acc 21.5300 best val_acc 29.301948
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 225 | val loss 1.8850 val acc 29.3019 best val_acc 32.548701
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 250 | val loss 1.8795 val acc 30.2151 best val_acc 34.070617
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 275 | val loss 1.8529 val acc 31.0471 best val_acc 38.717532
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 300 | val loss 1.8852 val acc 30.1136 best val_acc 38.717532
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 325 | val loss 2.1510 val acc 21.5300 best val_acc 38.717532
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 350 | val loss 1.9350 val acc 28.6323 best val_acc 38.717532
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 375 | val loss 2.0586 val acc 25.2232 best val_acc 38.940747
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 400 | val loss 2.0866 val acc 24.8985 best val_acc 40.787338
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 425 | val loss 1.7278 val acc 37.2768 best val_acc 42.836851
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 450 | val loss 1.6424 val acc 40.7265 best val_acc 45.819805
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 475 | val loss 1.7036 val acc 39.1437 best val_acc 46.063312
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 500 | val loss 1.5556 val acc 44.9067 best val_acc 47.280844
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 525 | val loss 1.7491 val acc 38.0682 best val_acc 48.275162
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 550 | val loss 1.6090 val acc 40.8482 best val_acc 48.275162
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 575 | val loss 1.8892 val acc 34.3141 best val_acc 48.457792
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 600 | val loss 1.5380 val acc 44.3791 best val_acc 48.721591
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 625 | val loss 1.4990 val acc 46.7127 best val_acc 50.608766
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 650 | val loss 1.4143 val acc 49.2289 best val_acc 51.095779
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 675 | val loss 1.4701 val acc 48.4375 best val_acc 51.704545
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 700 | val loss 2.5186 val acc 20.2313 best val_acc 51.846591
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 725 | val loss 2.1714 val acc 20.7386 best val_acc 51.846591
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 750 | val loss 2.1174 val acc 20.1705 best val_acc 51.846591
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 775 | val loss 2.0638 val acc 26.4002 best val_acc 51.846591
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 800 | val loss 2.4575 val acc 10.0244 best val_acc 51.846591
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 825 | val loss 2.0747 val acc 23.2752 best val_acc 51.846591
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 850 | val loss 1.9509 val acc 31.0065 best val_acc 51.846591
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 875 | val loss 1.9304 val acc 30.3166 best val_acc 51.846591
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 900 | val loss 1.4022 val acc 48.5187 best val_acc 51.846591
Norm_bounding: at our_attack_min_eigenvalue n_at 10  e 925 | val loss 1.4002 val acc 50.5479 best val_acc 51.846591
val loss 4509.748415 too high
change new seed now epoch: 943
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 5 e 0 | val loss 2.3023 val acc 11.5057 best val_acc 11.505682
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 25 | val loss 2.2343 val acc 16.9440 best val_acc 21.083604
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 1 e 50 | val loss 2.2430 val acc 16.9034 best val_acc 22.808442
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 75 | val loss 2.1518 val acc 18.8312 best val_acc 22.808442
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 4 e 100 | val loss 2.1271 val acc 19.3791 best val_acc 22.808442
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 125 | val loss 2.1660 val acc 22.5244 best val_acc 23.315747
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 2 e 150 | val loss 2.3414 val acc 10.3287 best val_acc 24.736201
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 5 e 175 | val loss 2.1114 val acc 21.8547 best val_acc 27.739448
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 2 e 200 | val loss 2.0976 val acc 23.4984 best val_acc 29.829545
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 4 e 225 | val loss 1.9540 val acc 24.2898 best val_acc 29.829545
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 2 e 250 | val loss 1.8668 val acc 28.5714 best val_acc 31.026786
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 2 e 275 | val loss 1.8485 val acc 29.9107 best val_acc 32.508117
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 2 e 300 | val loss 1.8087 val acc 33.7459 best val_acc 34.050325
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 325 | val loss 1.8007 val acc 33.9894 best val_acc 36.160714
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 1 e 350 | val loss 1.7860 val acc 31.4732 best val_acc 36.343344
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 375 | val loss 1.6639 val acc 39.5901 best val_acc 39.590097
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 4 e 400 | val loss 1.6720 val acc 38.6567 best val_acc 40.300325
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 5 e 425 | val loss 1.5949 val acc 42.0252 best val_acc 42.025162
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 5 e 450 | val loss 1.5859 val acc 41.0714 best val_acc 42.248377
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 475 | val loss 1.6611 val acc 40.3815 best val_acc 46.347403
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 4 e 500 | val loss 1.6236 val acc 40.4424 best val_acc 46.712662
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 525 | val loss 1.4578 val acc 46.5706 best val_acc 48.538961
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 2 e 550 | val loss 2.3371 val acc 18.6891 best val_acc 48.538961
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 2 e 575 | val loss 2.2112 val acc 16.3149 best val_acc 48.538961
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 600 | val loss 1.9786 val acc 22.7881 best val_acc 48.538961
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 4 e 625 | val loss 1.8207 val acc 33.9489 best val_acc 48.538961
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 650 | val loss 1.7192 val acc 37.9870 best val_acc 48.538961
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 5 e 675 | val loss 1.9254 val acc 30.7833 best val_acc 48.538961
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 2 e 700 | val loss 1.5743 val acc 43.0195 best val_acc 48.538961
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 725 | val loss 1.8293 val acc 35.7549 best val_acc 48.538961
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 750 | val loss 1.7467 val acc 36.3028 best val_acc 49.553571
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 775 | val loss 1.4380 val acc 48.1128 best val_acc 49.553571
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 800 | val loss 1.5564 val acc 44.0544 best val_acc 50.202922
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 825 | val loss 1.5640 val acc 45.0081 best val_acc 50.202922
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 850 | val loss 1.4413 val acc 48.7013 best val_acc 50.426136
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 875 | val loss 1.5960 val acc 43.6080 best val_acc 52.861201
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 900 | val loss 1.2888 val acc 53.1453 best val_acc 53.145292
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 5 e 925 | val loss 1.3671 val acc 51.7045 best val_acc 53.449675
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 4 e 950 | val loss 1.4119 val acc 48.8028 best val_acc 54.220779
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 4 e 975 | val loss 1.2292 val acc 56.2094 best val_acc 56.209416
New learnin rate  0.25
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 4 e 1000 | val loss 1.2016 val acc 57.6299 best val_acc 57.629870
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 1025 | val loss 1.1845 val acc 57.9951 best val_acc 59.030032
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 5 e 1050 | val loss 1.2097 val acc 56.8994 best val_acc 59.030032
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 4 e 1075 | val loss 1.2767 val acc 54.7078 best val_acc 59.496753
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 1100 | val loss 1.2716 val acc 54.7890 best val_acc 59.496753
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 1125 | val loss 1.2291 val acc 56.2094 best val_acc 59.496753
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 1150 | val loss 1.3974 val acc 50.8726 best val_acc 59.517045
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 4 e 1175 | val loss 1.1625 val acc 58.6648 best val_acc 59.821429
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 1199 | val loss 1.2856 val acc 55.1339 best val_acc 59.821429
Multi_krum: at our_attack_cos_second n_at 5 n_mal_sel 3 e 1200 | val loss 1.2845 val acc 53.9164 best val_acc 59.821429
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 0 | val loss 2.3024 val acc 9.7606 best val_acc 9.760552
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 25 | val loss 2.1850 val acc 18.8312 best val_acc 18.831169
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 50 | val loss 2.2504 val acc 14.6510 best val_acc 20.109578
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 75 | val loss 2.1720 val acc 19.1761 best val_acc 20.109578
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 100 | val loss 2.3369 val acc 9.9635 best val_acc 23.599838
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 125 | val loss 2.0997 val acc 17.4919 best val_acc 24.492695
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 150 | val loss 2.1834 val acc 17.7557 best val_acc 27.029221
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 175 | val loss 2.1299 val acc 18.7906 best val_acc 27.029221
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 200 | val loss 2.2270 val acc 16.4164 best val_acc 27.029221
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 225 | val loss 1.9958 val acc 23.8636 best val_acc 27.029221
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 250 | val loss 1.9457 val acc 25.4464 best val_acc 27.942370
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 275 | val loss 2.2387 val acc 22.4432 best val_acc 29.484578
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 300 | val loss 1.9908 val acc 25.0000 best val_acc 31.310877
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 325 | val loss 1.7218 val acc 34.9432 best val_acc 35.166396
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 350 | val loss 1.8206 val acc 30.6412 best val_acc 36.769481
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 375 | val loss 2.0158 val acc 23.1331 best val_acc 36.769481
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 400 | val loss 1.8590 val acc 32.6299 best val_acc 38.555195
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 425 | val loss 1.7910 val acc 33.7459 best val_acc 40.077110
krum: at our_attack_cos_second n_at 5 n_mal_sel 1 e 450 | val loss 1.6807 val acc 39.4278 best val_acc 41.497565
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 475 | val loss 1.6048 val acc 40.3206 best val_acc 41.497565
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 500 | val loss 1.7799 val acc 34.4562 best val_acc 44.399351
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 525 | val loss 1.6424 val acc 39.9148 best val_acc 44.399351
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 550 | val loss 1.8151 val acc 36.4042 best val_acc 44.987825
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 575 | val loss 1.6379 val acc 40.2597 best val_acc 44.987825
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 600 | val loss 1.6108 val acc 41.9440 best val_acc 44.987825
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 625 | val loss 1.8522 val acc 30.3571 best val_acc 46.448864
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 650 | val loss 1.5944 val acc 42.5731 best val_acc 46.448864
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 675 | val loss 1.9765 val acc 32.8734 best val_acc 46.448864
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 700 | val loss 1.8092 val acc 32.3255 best val_acc 46.448864
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 725 | val loss 1.6264 val acc 45.2922 best val_acc 47.828734
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 750 | val loss 1.5913 val acc 41.6193 best val_acc 49.269481
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 775 | val loss 1.6311 val acc 42.2078 best val_acc 49.269481
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 800 | val loss 1.7796 val acc 43.2833 best val_acc 49.269481
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 825 | val loss 1.7411 val acc 37.8044 best val_acc 49.269481
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 850 | val loss 1.6609 val acc 40.1989 best val_acc 49.269481
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 875 | val loss 1.6815 val acc 39.8133 best val_acc 49.310065
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 900 | val loss 1.4911 val acc 49.8377 best val_acc 50.243506
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 925 | val loss 1.5280 val acc 43.9529 best val_acc 50.994318
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 950 | val loss 1.6902 val acc 40.8482 best val_acc 50.994318
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 975 | val loss 1.7878 val acc 41.5179 best val_acc 50.994318
New learnin rate  0.25
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 1000 | val loss 1.5499 val acc 45.8401 best val_acc 51.481331
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 1025 | val loss 2.0173 val acc 51.6843 best val_acc 52.191558
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 1050 | val loss 2.3607 val acc 51.2784 best val_acc 52.191558
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 1075 | val loss 3.0460 val acc 51.6031 best val_acc 52.191558
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 1100 | val loss 3.4385 val acc 51.6031 best val_acc 52.191558
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 1125 | val loss 3.6942 val acc 51.6843 best val_acc 52.191558
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 1150 | val loss 3.8796 val acc 51.5625 best val_acc 52.191558
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 1175 | val loss 4.0289 val acc 51.6234 best val_acc 52.191558
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 1199 | val loss 4.1457 val acc 51.5422 best val_acc 52.191558
krum: at our_attack_cos_second n_at 5 n_mal_sel 0 e 1200 | val loss 4.1502 val acc 51.5016 best val_acc 52.191558
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 5 e 0 | val loss 2.3023 val acc 9.8214 best val_acc 9.821429
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 5 e 25 | val loss 2.3018 val acc 9.7606 best val_acc 18.405032
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 50 | val loss 2.2753 val acc 17.1063 best val_acc 18.405032
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 5 e 75 | val loss 2.0726 val acc 19.6023 best val_acc 21.875000
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 100 | val loss 2.2830 val acc 14.9959 best val_acc 24.736201
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 2 e 125 | val loss 2.0345 val acc 19.8255 best val_acc 24.736201
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 150 | val loss 2.2030 val acc 18.5268 best val_acc 24.736201
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 2 e 175 | val loss 2.2090 val acc 15.5032 best val_acc 24.736201
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 200 | val loss 2.1175 val acc 20.1502 best val_acc 24.736201
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 225 | val loss 2.2987 val acc 10.4099 best val_acc 24.736201
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 2 e 250 | val loss 2.2590 val acc 15.7468 best val_acc 24.736201
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 5 e 275 | val loss 2.4094 val acc 13.0276 best val_acc 24.736201
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 300 | val loss 2.2010 val acc 17.3904 best val_acc 24.736201
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 325 | val loss 2.1742 val acc 15.7062 best val_acc 24.736201
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 2 e 350 | val loss 2.1226 val acc 21.0227 best val_acc 27.394481
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 375 | val loss 2.1229 val acc 20.1502 best val_acc 28.754058
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 5 e 400 | val loss 1.8873 val acc 30.0122 best val_acc 30.925325
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 425 | val loss 2.0148 val acc 23.3360 best val_acc 30.925325
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 5 e 450 | val loss 1.9439 val acc 27.4959 best val_acc 32.163149
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 5 e 475 | val loss 1.7571 val acc 35.1664 best val_acc 37.621753
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 500 | val loss 1.8713 val acc 30.6615 best val_acc 37.621753
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 525 | val loss 1.8939 val acc 29.5252 best val_acc 37.723214
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 5 e 550 | val loss 1.7341 val acc 36.5666 best val_acc 39.042208
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 575 | val loss 1.9395 val acc 33.5633 best val_acc 39.042208
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 600 | val loss 1.6881 val acc 37.0536 best val_acc 40.665584
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 625 | val loss 1.7981 val acc 34.6591 best val_acc 42.451299
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 650 | val loss 1.7202 val acc 37.1347 best val_acc 42.816558
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 5 e 675 | val loss 1.6768 val acc 39.5901 best val_acc 43.912338
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 700 | val loss 2.1757 val acc 21.2662 best val_acc 43.912338
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 725 | val loss 1.6493 val acc 39.5698 best val_acc 43.912338
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 750 | val loss 2.1197 val acc 27.1916 best val_acc 46.753247
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 5 e 775 | val loss 1.7729 val acc 39.0016 best val_acc 46.753247
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 800 | val loss 1.6622 val acc 40.7670 best val_acc 47.646104
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 825 | val loss 1.7948 val acc 32.8328 best val_acc 47.646104
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 850 | val loss 2.0072 val acc 35.0446 best val_acc 47.646104
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 5 e 875 | val loss 1.5601 val acc 45.9010 best val_acc 47.646104
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 900 | val loss 1.5443 val acc 44.3588 best val_acc 50.263799
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 925 | val loss 1.5501 val acc 43.9529 best val_acc 50.263799
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 950 | val loss 1.6098 val acc 43.4862 best val_acc 50.263799
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 975 | val loss 1.8242 val acc 33.6648 best val_acc 50.263799
New learnin rate  0.25
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 1000 | val loss 1.4429 val acc 48.6404 best val_acc 50.263799
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 1025 | val loss 1.4139 val acc 47.5649 best val_acc 52.840909
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 1050 | val loss 1.3473 val acc 50.8929 best val_acc 53.551136
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 5 e 1075 | val loss 1.3377 val acc 52.5974 best val_acc 53.591721
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 1100 | val loss 1.4349 val acc 49.1680 best val_acc 53.977273
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 1125 | val loss 1.4191 val acc 50.5276 best val_acc 53.977273
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 1150 | val loss 1.3466 val acc 51.6640 best val_acc 53.977273
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 3 e 1175 | val loss 1.4412 val acc 48.9854 best val_acc 53.977273
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 5 e 1199 | val loss 1.2978 val acc 54.1599 best val_acc 54.241071
Bulyan: at our_attack_cos_second n_at 5 n_mal_sel 4 e 1200 | val loss 1.3457 val acc 52.0495 best val_acc 54.241071
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Median: at our_attack_cos_second n_at 5  e 0 | val loss 2.3023 val acc 10.2273 best val_acc 10.227273
Median: at our_attack_cos_second n_at 5  e 25 | val loss 2.2988 val acc 12.0942 best val_acc 21.408279
Median: at our_attack_cos_second n_at 5  e 50 | val loss 2.2038 val acc 17.6745 best val_acc 21.408279
Median: at our_attack_cos_second n_at 5  e 75 | val loss 2.2758 val acc 12.7435 best val_acc 21.408279
Median: at our_attack_cos_second n_at 5  e 100 | val loss 2.1012 val acc 21.8141 best val_acc 23.234578
Median: at our_attack_cos_second n_at 5  e 125 | val loss 2.0680 val acc 20.7589 best val_acc 24.878247
Median: at our_attack_cos_second n_at 5  e 150 | val loss 2.1787 val acc 15.8076 best val_acc 26.420455
Median: at our_attack_cos_second n_at 5  e 175 | val loss 2.0939 val acc 22.8084 best val_acc 28.145292
Median: at our_attack_cos_second n_at 5  e 200 | val loss 1.9843 val acc 24.3304 best val_acc 31.676136
Median: at our_attack_cos_second n_at 5  e 225 | val loss 1.9286 val acc 30.0325 best val_acc 31.676136
Median: at our_attack_cos_second n_at 5  e 250 | val loss 2.2133 val acc 22.5852 best val_acc 33.847403
Median: at our_attack_cos_second n_at 5  e 275 | val loss 2.6003 val acc 16.3149 best val_acc 35.795455
Median: at our_attack_cos_second n_at 5  e 300 | val loss 2.0346 val acc 25.0203 best val_acc 35.795455
Median: at our_attack_cos_second n_at 5  e 325 | val loss 1.9337 val acc 28.8758 best val_acc 35.795455
Median: at our_attack_cos_second n_at 5  e 350 | val loss 1.9312 val acc 29.2817 best val_acc 35.896916
Median: at our_attack_cos_second n_at 5  e 375 | val loss 1.8568 val acc 35.1055 best val_acc 37.844968
Median: at our_attack_cos_second n_at 5  e 400 | val loss 1.7764 val acc 35.8969 best val_acc 41.254058
Median: at our_attack_cos_second n_at 5  e 425 | val loss 2.2682 val acc 16.3961 best val_acc 42.045455
Median: at our_attack_cos_second n_at 5  e 450 | val loss 1.9318 val acc 30.6615 best val_acc 42.045455
Median: at our_attack_cos_second n_at 5  e 475 | val loss 2.0751 val acc 24.3506 best val_acc 42.045455
Median: at our_attack_cos_second n_at 5  e 500 | val loss 1.9763 val acc 26.0146 best val_acc 42.045455
Median: at our_attack_cos_second n_at 5  e 525 | val loss 1.8476 val acc 35.2273 best val_acc 42.045455
Median: at our_attack_cos_second n_at 5  e 550 | val loss 1.7050 val acc 37.5203 best val_acc 42.897727
Median: at our_attack_cos_second n_at 5  e 575 | val loss 1.6509 val acc 39.2248 best val_acc 44.013799
Median: at our_attack_cos_second n_at 5  e 600 | val loss 1.6367 val acc 40.7265 best val_acc 44.013799
Median: at our_attack_cos_second n_at 5  e 625 | val loss 2.0623 val acc 32.8937 best val_acc 47.077922
Median: at our_attack_cos_second n_at 5  e 650 | val loss 1.7014 val acc 40.2394 best val_acc 47.077922
Median: at our_attack_cos_second n_at 5  e 675 | val loss 1.9657 val acc 34.4359 best val_acc 47.077922
Median: at our_attack_cos_second n_at 5  e 700 | val loss 1.6139 val acc 42.0252 best val_acc 47.686688
Median: at our_attack_cos_second n_at 5  e 725 | val loss 1.6580 val acc 41.7005 best val_acc 48.173701
Median: at our_attack_cos_second n_at 5  e 750 | val loss 1.8685 val acc 32.9343 best val_acc 48.863636
Median: at our_attack_cos_second n_at 5  e 775 | val loss 1.8337 val acc 36.7695 best val_acc 48.863636
Median: at our_attack_cos_second n_at 5  e 800 | val loss 1.6516 val acc 40.0974 best val_acc 49.756494
Median: at our_attack_cos_second n_at 5  e 825 | val loss 1.5558 val acc 44.4399 best val_acc 49.756494
Median: at our_attack_cos_second n_at 5  e 850 | val loss 1.6358 val acc 44.1558 best val_acc 50.324675
Median: at our_attack_cos_second n_at 5  e 875 | val loss 1.7446 val acc 34.2938 best val_acc 51.582792
Median: at our_attack_cos_second n_at 5  e 900 | val loss 1.7895 val acc 35.8157 best val_acc 51.582792
val loss 42290928.324675 too high
change new seed now epoch: 914
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
tr_mean: at our_attack_cos_second n_at 5  e 0 | val loss 2.3023 val acc 11.0390 best val_acc 11.038961
tr_mean: at our_attack_cos_second n_at 5  e 25 | val loss 2.3054 val acc 9.7403 best val_acc 20.109578
tr_mean: at our_attack_cos_second n_at 5  e 50 | val loss 2.2423 val acc 18.0398 best val_acc 20.109578
tr_mean: at our_attack_cos_second n_at 5  e 75 | val loss 2.2360 val acc 13.4740 best val_acc 22.301136
tr_mean: at our_attack_cos_second n_at 5  e 100 | val loss 2.2660 val acc 15.2394 best val_acc 22.301136
tr_mean: at our_attack_cos_second n_at 5  e 125 | val loss 2.0743 val acc 22.7476 best val_acc 24.736201
tr_mean: at our_attack_cos_second n_at 5  e 150 | val loss 2.0739 val acc 23.4984 best val_acc 25.669643
tr_mean: at our_attack_cos_second n_at 5  e 175 | val loss 1.9750 val acc 26.6437 best val_acc 28.916396
tr_mean: at our_attack_cos_second n_at 5  e 200 | val loss 2.1544 val acc 21.8344 best val_acc 28.916396
tr_mean: at our_attack_cos_second n_at 5  e 225 | val loss 2.2413 val acc 15.9903 best val_acc 28.916396
tr_mean: at our_attack_cos_second n_at 5  e 250 | val loss 1.9818 val acc 22.4026 best val_acc 28.916396
tr_mean: at our_attack_cos_second n_at 5  e 275 | val loss 1.9848 val acc 25.1420 best val_acc 32.670455
tr_mean: at our_attack_cos_second n_at 5  e 300 | val loss 2.1234 val acc 22.4229 best val_acc 33.482143
tr_mean: at our_attack_cos_second n_at 5  e 325 | val loss 1.8971 val acc 29.5049 best val_acc 33.482143
tr_mean: at our_attack_cos_second n_at 5  e 350 | val loss 2.2797 val acc 14.1640 best val_acc 36.404221
tr_mean: at our_attack_cos_second n_at 5  e 375 | val loss 2.1173 val acc 25.0203 best val_acc 36.404221
tr_mean: at our_attack_cos_second n_at 5  e 400 | val loss 1.9823 val acc 25.1623 best val_acc 38.758117
tr_mean: at our_attack_cos_second n_at 5  e 425 | val loss 1.6883 val acc 37.6015 best val_acc 38.758117
tr_mean: at our_attack_cos_second n_at 5  e 450 | val loss 1.7457 val acc 34.3141 best val_acc 42.674513
tr_mean: at our_attack_cos_second n_at 5  e 475 | val loss 1.9176 val acc 29.9513 best val_acc 43.709416
tr_mean: at our_attack_cos_second n_at 5  e 500 | val loss 1.6631 val acc 38.1899 best val_acc 43.709416
val loss 4892099.527597 too high
change new seed now epoch: 511
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
FedAvg: at our_attack_cos_second n_at 5  e 0 | val loss 2.3023 val acc 11.2622 best val_acc 11.262175
FedAvg: at our_attack_cos_second n_at 5  e 25 | val loss 2.6435 val acc 12.6623 best val_acc 20.211039
FedAvg: at our_attack_cos_second n_at 5  e 50 | val loss 2.3027 val acc 10.6737 best val_acc 20.211039
FedAvg: at our_attack_cos_second n_at 5  e 75 | val loss 2.2441 val acc 17.7557 best val_acc 21.631494
FedAvg: at our_attack_cos_second n_at 5  e 100 | val loss 2.2282 val acc 15.5235 best val_acc 23.173701
FedAvg: at our_attack_cos_second n_at 5  e 125 | val loss 2.0975 val acc 21.5097 best val_acc 23.173701
FedAvg: at our_attack_cos_second n_at 5  e 150 | val loss 2.0572 val acc 21.1445 best val_acc 23.173701
FedAvg: at our_attack_cos_second n_at 5  e 175 | val loss 1.9542 val acc 27.0292 best val_acc 27.029221
FedAvg: at our_attack_cos_second n_at 5  e 200 | val loss 2.1607 val acc 16.6802 best val_acc 27.759740
FedAvg: at our_attack_cos_second n_at 5  e 225 | val loss 1.9810 val acc 21.9765 best val_acc 27.759740
FedAvg: at our_attack_cos_second n_at 5  e 250 | val loss 1.9062 val acc 28.3888 best val_acc 28.388799
FedAvg: at our_attack_cos_second n_at 5  e 275 | val loss 1.9827 val acc 22.9099 best val_acc 29.646916
FedAvg: at our_attack_cos_second n_at 5  e 300 | val loss 2.0266 val acc 26.5219 best val_acc 29.646916
FedAvg: at our_attack_cos_second n_at 5  e 325 | val loss 1.9797 val acc 26.8669 best val_acc 33.218344
FedAvg: at our_attack_cos_second n_at 5  e 350 | val loss 1.8505 val acc 30.4586 best val_acc 33.218344
FedAvg: at our_attack_cos_second n_at 5  e 375 | val loss 1.8965 val acc 29.7281 best val_acc 34.862013
FedAvg: at our_attack_cos_second n_at 5  e 400 | val loss 1.9467 val acc 28.1250 best val_acc 35.146104
FedAvg: at our_attack_cos_second n_at 5  e 425 | val loss 1.7229 val acc 37.0130 best val_acc 40.137987
FedAvg: at our_attack_cos_second n_at 5  e 450 | val loss 1.6992 val acc 34.2938 best val_acc 40.137987
FedAvg: at our_attack_cos_second n_at 5  e 475 | val loss 1.6651 val acc 40.2597 best val_acc 40.259740
FedAvg: at our_attack_cos_second n_at 5  e 500 | val loss 1.5916 val acc 43.3239 best val_acc 43.323864
FedAvg: at our_attack_cos_second n_at 5  e 525 | val loss 1.8289 val acc 30.1339 best val_acc 45.150162
FedAvg: at our_attack_cos_second n_at 5  e 550 | val loss 1.6891 val acc 37.1753 best val_acc 45.150162
FedAvg: at our_attack_cos_second n_at 5  e 575 | val loss 1.6281 val acc 42.1063 best val_acc 45.150162
FedAvg: at our_attack_cos_second n_at 5  e 600 | val loss 1.7002 val acc 37.2159 best val_acc 45.150162
FedAvg: at our_attack_cos_second n_at 5  e 625 | val loss 1.8858 val acc 31.3920 best val_acc 45.150162
FedAvg: at our_attack_cos_second n_at 5  e 650 | val loss 1.5838 val acc 42.5122 best val_acc 45.556006
FedAvg: at our_attack_cos_second n_at 5  e 675 | val loss 1.5383 val acc 44.2776 best val_acc 47.199675
FedAvg: at our_attack_cos_second n_at 5  e 700 | val loss 1.6318 val acc 42.9383 best val_acc 47.828734
FedAvg: at our_attack_cos_second n_at 5  e 725 | val loss 1.4397 val acc 49.9188 best val_acc 49.918831
FedAvg: at our_attack_cos_second n_at 5  e 750 | val loss 1.6069 val acc 43.2630 best val_acc 49.918831
FedAvg: at our_attack_cos_second n_at 5  e 775 | val loss 1.5780 val acc 42.0252 best val_acc 50.649351
FedAvg: at our_attack_cos_second n_at 5  e 800 | val loss 1.5739 val acc 45.0690 best val_acc 51.298701
FedAvg: at our_attack_cos_second n_at 5  e 825 | val loss 1.3472 val acc 51.1364 best val_acc 52.353896
FedAvg: at our_attack_cos_second n_at 5  e 850 | val loss 1.4848 val acc 47.3214 best val_acc 52.353896
FedAvg: at our_attack_cos_second n_at 5  e 875 | val loss 1.7760 val acc 36.4245 best val_acc 52.353896
FedAvg: at our_attack_cos_second n_at 5  e 900 | val loss 1.4072 val acc 49.5536 best val_acc 53.490260
FedAvg: at our_attack_cos_second n_at 5  e 925 | val loss 2.1927 val acc 17.0252 best val_acc 53.490260
FedAvg: at our_attack_cos_second n_at 5  e 950 | val loss 2.4440 val acc 15.4424 best val_acc 53.490260
FedAvg: at our_attack_cos_second n_at 5  e 975 | val loss 1.8351 val acc 38.6161 best val_acc 53.490260
New learnin rate  0.25
FedAvg: at our_attack_cos_second n_at 5  e 1000 | val loss 1.5424 val acc 44.1558 best val_acc 53.490260
FedAvg: at our_attack_cos_second n_at 5  e 1025 | val loss 1.2642 val acc 54.6469 best val_acc 55.255682
FedAvg: at our_attack_cos_second n_at 5  e 1050 | val loss 1.2583 val acc 54.9716 best val_acc 55.844156
FedAvg: at our_attack_cos_second n_at 5  e 1075 | val loss 1.2563 val acc 55.9659 best val_acc 56.331169
FedAvg: at our_attack_cos_second n_at 5  e 1100 | val loss 1.3475 val acc 53.5511 best val_acc 57.264610
FedAvg: at our_attack_cos_second n_at 5  e 1125 | val loss 1.2534 val acc 54.8498 best val_acc 57.568994
FedAvg: at our_attack_cos_second n_at 5  e 1150 | val loss 1.2971 val acc 53.6729 best val_acc 57.568994
FedAvg: at our_attack_cos_second n_at 5  e 1175 | val loss 1.2588 val acc 53.6932 best val_acc 57.568994
FedAvg: at our_attack_cos_second n_at 5  e 1199 | val loss 1.4434 val acc 50.5073 best val_acc 57.568994
FedAvg: at our_attack_cos_second n_at 5  e 1200 | val loss 1.3268 val acc 52.7394 best val_acc 57.568994
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Norm_bounding: at our_attack_cos_second n_at 5  e 0 | val loss 2.3023 val acc 11.2216 best val_acc 11.221591
Norm_bounding: at our_attack_cos_second n_at 5  e 25 | val loss 2.3011 val acc 10.5519 best val_acc 22.077922
Norm_bounding: at our_attack_cos_second n_at 5  e 50 | val loss 2.1268 val acc 22.2808 best val_acc 22.382305
Norm_bounding: at our_attack_cos_second n_at 5  e 75 | val loss 2.1431 val acc 19.7849 best val_acc 22.382305
Norm_bounding: at our_attack_cos_second n_at 5  e 100 | val loss 2.2062 val acc 17.6745 best val_acc 22.382305
Norm_bounding: at our_attack_cos_second n_at 5  e 125 | val loss 2.3524 val acc 19.2370 best val_acc 24.675325
Norm_bounding: at our_attack_cos_second n_at 5  e 150 | val loss 2.2423 val acc 20.8401 best val_acc 25.831981
Norm_bounding: at our_attack_cos_second n_at 5  e 175 | val loss 2.0298 val acc 23.2752 best val_acc 28.896104
Norm_bounding: at our_attack_cos_second n_at 5  e 200 | val loss 1.9559 val acc 28.0844 best val_acc 29.241071
Norm_bounding: at our_attack_cos_second n_at 5  e 225 | val loss 1.8796 val acc 30.9862 best val_acc 34.030032
Norm_bounding: at our_attack_cos_second n_at 5  e 250 | val loss 1.7298 val acc 36.3839 best val_acc 36.383929
Norm_bounding: at our_attack_cos_second n_at 5  e 275 | val loss 1.8191 val acc 32.0211 best val_acc 37.175325
Norm_bounding: at our_attack_cos_second n_at 5  e 300 | val loss 1.7804 val acc 34.7606 best val_acc 37.987013
Norm_bounding: at our_attack_cos_second n_at 5  e 325 | val loss 1.6452 val acc 41.3555 best val_acc 41.355519
Norm_bounding: at our_attack_cos_second n_at 5  e 350 | val loss 1.7341 val acc 36.2013 best val_acc 41.862825
Norm_bounding: at our_attack_cos_second n_at 5  e 375 | val loss 1.5579 val acc 41.5381 best val_acc 42.958604
Norm_bounding: at our_attack_cos_second n_at 5  e 400 | val loss 1.6734 val acc 39.7930 best val_acc 44.906656
Norm_bounding: at our_attack_cos_second n_at 5  e 425 | val loss 1.4811 val acc 46.1648 best val_acc 46.164773
Norm_bounding: at our_attack_cos_second n_at 5  e 450 | val loss 1.5093 val acc 45.2313 best val_acc 47.280844
Norm_bounding: at our_attack_cos_second n_at 5  e 475 | val loss 1.5401 val acc 45.4140 best val_acc 47.382305
Norm_bounding: at our_attack_cos_second n_at 5  e 500 | val loss 1.7024 val acc 42.7557 best val_acc 48.417208
Norm_bounding: at our_attack_cos_second n_at 5  e 525 | val loss 1.6762 val acc 42.9789 best val_acc 50.020292
Norm_bounding: at our_attack_cos_second n_at 5  e 550 | val loss 1.9065 val acc 28.7338 best val_acc 50.020292
Norm_bounding: at our_attack_cos_second n_at 5  e 575 | val loss 1.4370 val acc 49.8377 best val_acc 50.020292
Norm_bounding: at our_attack_cos_second n_at 5  e 600 | val loss 1.4616 val acc 48.1534 best val_acc 50.223214
Norm_bounding: at our_attack_cos_second n_at 5  e 625 | val loss 1.4348 val acc 48.0317 best val_acc 51.440747
Norm_bounding: at our_attack_cos_second n_at 5  e 650 | val loss 1.4840 val acc 46.2459 best val_acc 51.440747
Norm_bounding: at our_attack_cos_second n_at 5  e 675 | val loss 1.3774 val acc 50.1218 best val_acc 52.333604
Norm_bounding: at our_attack_cos_second n_at 5  e 700 | val loss 1.4110 val acc 49.4927 best val_acc 54.159903
Norm_bounding: at our_attack_cos_second n_at 5  e 725 | val loss 1.5285 val acc 45.3125 best val_acc 54.728084
Norm_bounding: at our_attack_cos_second n_at 5  e 750 | val loss 1.2363 val acc 55.8442 best val_acc 55.844156
Norm_bounding: at our_attack_cos_second n_at 5  e 775 | val loss 6.1523 val acc 11.2216 best val_acc 55.844156
val loss 2469.562306 too high
change new seed now epoch: 777
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 0 | val loss 2.3023 val acc 11.5057 best val_acc 11.505682
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 25 | val loss 2.1962 val acc 18.1615 best val_acc 20.657468
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 50 | val loss 2.1048 val acc 18.7297 best val_acc 20.657468
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 75 | val loss 2.1540 val acc 17.7557 best val_acc 20.657468
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 100 | val loss 2.0390 val acc 20.3734 best val_acc 22.889610
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 125 | val loss 2.0384 val acc 24.3506 best val_acc 28.043831
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 150 | val loss 2.0803 val acc 21.5097 best val_acc 31.310877
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 175 | val loss 1.9191 val acc 28.8758 best val_acc 31.310877
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 200 | val loss 1.8363 val acc 32.3052 best val_acc 35.166396
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 225 | val loss 1.7875 val acc 35.2476 best val_acc 35.247565
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 250 | val loss 2.1048 val acc 23.9854 best val_acc 38.250812
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 275 | val loss 1.7644 val acc 35.5519 best val_acc 38.250812
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 300 | val loss 1.8072 val acc 36.4245 best val_acc 42.370130
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 325 | val loss 1.7059 val acc 37.2362 best val_acc 42.370130
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 350 | val loss 1.5709 val acc 44.6023 best val_acc 44.602273
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 375 | val loss 1.6570 val acc 39.7321 best val_acc 46.022727
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 400 | val loss 1.4699 val acc 46.0024 best val_acc 47.057630
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 425 | val loss 1.5398 val acc 45.2719 best val_acc 47.057630
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 450 | val loss 1.5312 val acc 44.6429 best val_acc 49.066558
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 475 | val loss 1.4774 val acc 46.1648 best val_acc 49.614448
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 500 | val loss 1.4428 val acc 48.3766 best val_acc 50.568182
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 525 | val loss 1.6186 val acc 40.4018 best val_acc 50.710227
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 550 | val loss 1.3924 val acc 49.9391 best val_acc 52.536526
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 575 | val loss 1.3653 val acc 50.2232 best val_acc 52.536526
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 600 | val loss 1.4306 val acc 49.0463 best val_acc 54.788961
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 625 | val loss 1.5099 val acc 49.2492 best val_acc 55.864448
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 650 | val loss 1.4721 val acc 44.5008 best val_acc 55.864448
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 675 | val loss 1.3281 val acc 53.5714 best val_acc 55.864448
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 700 | val loss 1.4271 val acc 49.4724 best val_acc 55.864448
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 725 | val loss 1.8925 val acc 37.9464 best val_acc 55.864448
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 750 | val loss 1.2690 val acc 55.3166 best val_acc 56.006494
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 775 | val loss 1.4037 val acc 51.5828 best val_acc 56.432630
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 800 | val loss 1.3501 val acc 54.2614 best val_acc 58.380682
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 825 | val loss 1.3089 val acc 54.4237 best val_acc 58.380682
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 850 | val loss 1.2865 val acc 54.0787 best val_acc 58.380682
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 875 | val loss 1.1408 val acc 60.0852 best val_acc 60.085227
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 900 | val loss 1.9939 val acc 28.5511 best val_acc 60.085227
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 925 | val loss 1.1605 val acc 59.4156 best val_acc 60.085227
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 950 | val loss 1.2958 val acc 55.5601 best val_acc 60.085227
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 975 | val loss 1.3475 val acc 54.5657 best val_acc 60.085227
New learnin rate  0.25
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 1000 | val loss 1.0843 val acc 62.6218 best val_acc 62.621753
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 1025 | val loss 1.0877 val acc 63.4943 best val_acc 64.671266
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 1050 | val loss 1.1361 val acc 62.2768 best val_acc 64.671266
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 1075 | val loss 1.1775 val acc 60.9375 best val_acc 64.671266
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 1100 | val loss 1.1320 val acc 61.3433 best val_acc 64.671266
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 1125 | val loss 1.2675 val acc 59.2330 best val_acc 64.671266
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 1150 | val loss 1.1424 val acc 61.8304 best val_acc 64.671266
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 1175 | val loss 1.1979 val acc 63.5755 best val_acc 64.671266
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 1199 | val loss 1.1881 val acc 63.3320 best val_acc 64.671266
Multi_krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 1200 | val loss 1.1906 val acc 62.0130 best val_acc 64.671266
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 0 e 0 | val loss 2.3024 val acc 9.7606 best val_acc 9.760552
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 0 e 25 | val loss 2.3003 val acc 12.2971 best val_acc 17.877435
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 0 e 50 | val loss 2.3102 val acc 9.6185 best val_acc 20.068994
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 0 e 75 | val loss 2.3060 val acc 10.3896 best val_acc 21.144481
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 100 | val loss 2.2973 val acc 10.2881 best val_acc 21.144481
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 125 | val loss 2.2603 val acc 16.9034 best val_acc 21.144481
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 0 e 150 | val loss 2.2953 val acc 12.4797 best val_acc 21.144481
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 175 | val loss 2.1510 val acc 20.6169 best val_acc 21.144481
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 200 | val loss 2.1462 val acc 19.2370 best val_acc 21.144481
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 0 e 225 | val loss 2.3244 val acc 11.3433 best val_acc 22.767857
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 250 | val loss 2.1068 val acc 20.1705 best val_acc 22.808442
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 0 e 275 | val loss 2.0679 val acc 19.7849 best val_acc 23.741883
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 300 | val loss 2.1935 val acc 15.9294 best val_acc 26.197240
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 325 | val loss 2.1092 val acc 19.1964 best val_acc 26.197240
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 350 | val loss 2.0582 val acc 21.0227 best val_acc 26.197240
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 375 | val loss 2.2817 val acc 11.8304 best val_acc 26.197240
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 400 | val loss 2.2223 val acc 11.3231 best val_acc 26.197240
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 0 e 425 | val loss 2.0080 val acc 18.8109 best val_acc 26.197240
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 0 e 450 | val loss 2.0180 val acc 20.3937 best val_acc 26.197240
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 475 | val loss 1.9636 val acc 24.2492 best val_acc 26.197240
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 500 | val loss 2.1544 val acc 14.6104 best val_acc 26.197240
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 525 | val loss 2.1459 val acc 19.8864 best val_acc 28.125000
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 550 | val loss 2.2438 val acc 15.9091 best val_acc 31.818182
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 575 | val loss 2.2312 val acc 14.1640 best val_acc 31.818182
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 600 | val loss 2.3759 val acc 15.0365 best val_acc 31.818182
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 0 e 625 | val loss 2.2195 val acc 15.8279 best val_acc 31.818182
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 650 | val loss 2.3523 val acc 11.1810 best val_acc 31.818182
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 675 | val loss 2.2090 val acc 13.0885 best val_acc 31.818182
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 700 | val loss 2.3160 val acc 11.6883 best val_acc 31.818182
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 0 e 725 | val loss 2.0095 val acc 21.2054 best val_acc 31.818182
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 750 | val loss 2.2404 val acc 15.1583 best val_acc 31.818182
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 775 | val loss 2.2164 val acc 18.0398 best val_acc 31.818182
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 800 | val loss 2.1166 val acc 18.6688 best val_acc 31.818182
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 825 | val loss 2.6198 val acc 13.1899 best val_acc 31.818182
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 850 | val loss 2.0537 val acc 21.0633 best val_acc 31.818182
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 875 | val loss 2.0834 val acc 20.3734 best val_acc 31.818182
krum: at our_attack_min_eigenvalue n_at 5 n_mal_sel 1 e 900 | val loss 1.9480 val acc 22.5446 best val_acc 31.818182
val loss 4256918.873377 too high
change new seed now epoch: 918
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 0 | val loss 2.3023 val acc 9.7606 best val_acc 9.760552
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 25 | val loss 2.3012 val acc 9.9026 best val_acc 18.729708
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 50 | val loss 2.2379 val acc 10.2070 best val_acc 20.860390
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 75 | val loss 2.1831 val acc 16.2946 best val_acc 20.860390
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 100 | val loss 2.3072 val acc 12.9058 best val_acc 20.860390
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 125 | val loss 2.1676 val acc 17.7963 best val_acc 20.860390
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 150 | val loss 2.2648 val acc 13.8393 best val_acc 22.991071
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 175 | val loss 2.0664 val acc 18.8920 best val_acc 22.991071
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 200 | val loss 2.1911 val acc 16.9643 best val_acc 23.741883
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 225 | val loss 2.3196 val acc 9.7403 best val_acc 28.003247
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 250 | val loss 2.2991 val acc 11.2013 best val_acc 28.003247
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 275 | val loss 1.9797 val acc 26.3393 best val_acc 28.003247
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 300 | val loss 1.9303 val acc 26.0958 best val_acc 30.803571
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 325 | val loss 1.7957 val acc 34.9026 best val_acc 34.902597
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 350 | val loss 1.9154 val acc 31.5747 best val_acc 35.064935
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 375 | val loss 1.8866 val acc 26.7451 best val_acc 36.992695
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 400 | val loss 1.9289 val acc 27.3742 best val_acc 39.285714
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 425 | val loss 1.7889 val acc 32.9140 best val_acc 39.488636
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 450 | val loss 2.0260 val acc 25.5479 best val_acc 39.569805
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 475 | val loss 1.9073 val acc 36.4854 best val_acc 41.517857
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 500 | val loss 1.9350 val acc 34.2735 best val_acc 41.517857
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 525 | val loss 1.8624 val acc 35.4505 best val_acc 41.781656
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 550 | val loss 1.8342 val acc 33.0357 best val_acc 43.567370
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 575 | val loss 1.7000 val acc 39.6104 best val_acc 44.764610
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 600 | val loss 1.6538 val acc 40.1177 best val_acc 44.764610
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 625 | val loss 1.6917 val acc 39.3060 best val_acc 45.596591
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 650 | val loss 1.8443 val acc 34.0706 best val_acc 46.530032
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 675 | val loss 1.9730 val acc 28.4294 best val_acc 47.463474
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 700 | val loss 1.5529 val acc 42.6745 best val_acc 48.153409
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 725 | val loss 2.5188 val acc 14.5089 best val_acc 48.620130
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 750 | val loss 1.6956 val acc 36.1201 best val_acc 48.620130
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 775 | val loss 1.4606 val acc 49.1477 best val_acc 49.147727
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 800 | val loss 1.7158 val acc 39.6104 best val_acc 50.710227
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 825 | val loss 1.5244 val acc 44.3994 best val_acc 50.710227
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 850 | val loss 1.3959 val acc 51.4002 best val_acc 51.400162
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 875 | val loss 1.4673 val acc 48.0519 best val_acc 51.400162
Bulyan: at our_attack_min_eigenvalue n_at 5 n_mal_sel 5 e 900 | val loss 16.5156 val acc 9.9635 best val_acc 51.400162
val loss 9705.551536 too high
change new seed now epoch: 903
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Median: at our_attack_min_eigenvalue n_at 5  e 0 | val loss 2.3023 val acc 10.1664 best val_acc 10.166396
Median: at our_attack_min_eigenvalue n_at 5  e 25 | val loss 2.3130 val acc 9.7403 best val_acc 20.860390
Median: at our_attack_min_eigenvalue n_at 5  e 50 | val loss 2.2896 val acc 14.3060 best val_acc 20.860390
Median: at our_attack_min_eigenvalue n_at 5  e 75 | val loss 2.1680 val acc 20.5154 best val_acc 23.518669
Median: at our_attack_min_eigenvalue n_at 5  e 100 | val loss 2.2427 val acc 14.0422 best val_acc 23.579545
Median: at our_attack_min_eigenvalue n_at 5  e 125 | val loss 2.0866 val acc 22.6867 best val_acc 23.579545
Median: at our_attack_min_eigenvalue n_at 5  e 150 | val loss 2.0806 val acc 20.4545 best val_acc 27.414773
Median: at our_attack_min_eigenvalue n_at 5  e 175 | val loss 2.2008 val acc 18.3239 best val_acc 27.495942
Median: at our_attack_min_eigenvalue n_at 5  e 200 | val loss 2.0365 val acc 21.2662 best val_acc 27.495942
Median: at our_attack_min_eigenvalue n_at 5  e 225 | val loss 1.9723 val acc 22.4026 best val_acc 27.495942
Median: at our_attack_min_eigenvalue n_at 5  e 250 | val loss 2.0312 val acc 24.5333 best val_acc 28.388799
Median: at our_attack_min_eigenvalue n_at 5  e 275 | val loss 1.7937 val acc 33.2183 best val_acc 33.218344
Median: at our_attack_min_eigenvalue n_at 5  e 300 | val loss 1.9606 val acc 26.7045 best val_acc 33.218344
Median: at our_attack_min_eigenvalue n_at 5  e 325 | val loss 1.8677 val acc 29.8093 best val_acc 33.218344
Median: at our_attack_min_eigenvalue n_at 5  e 350 | val loss 1.9457 val acc 25.4058 best val_acc 33.218344
Median: at our_attack_min_eigenvalue n_at 5  e 375 | val loss 1.9324 val acc 27.1307 best val_acc 33.218344
Median: at our_attack_min_eigenvalue n_at 5  e 400 | val loss 1.9173 val acc 26.8669 best val_acc 36.789773
Median: at our_attack_min_eigenvalue n_at 5  e 425 | val loss 1.7751 val acc 33.2386 best val_acc 38.027597
Median: at our_attack_min_eigenvalue n_at 5  e 450 | val loss 2.0850 val acc 24.1680 best val_acc 41.801948
Median: at our_attack_min_eigenvalue n_at 5  e 475 | val loss 1.7263 val acc 34.2532 best val_acc 42.004870
Median: at our_attack_min_eigenvalue n_at 5  e 500 | val loss 1.6371 val acc 40.9903 best val_acc 42.004870
Median: at our_attack_min_eigenvalue n_at 5  e 525 | val loss 1.5606 val acc 43.9123 best val_acc 44.115260
Median: at our_attack_min_eigenvalue n_at 5  e 550 | val loss 1.5658 val acc 45.7386 best val_acc 46.895292
Median: at our_attack_min_eigenvalue n_at 5  e 575 | val loss 1.5596 val acc 42.5122 best val_acc 46.895292
Median: at our_attack_min_eigenvalue n_at 5  e 600 | val loss 1.7627 val acc 36.3028 best val_acc 46.895292
Median: at our_attack_min_eigenvalue n_at 5  e 625 | val loss 1.5561 val acc 44.0138 best val_acc 47.849026
Median: at our_attack_min_eigenvalue n_at 5  e 650 | val loss 1.6324 val acc 43.7094 best val_acc 48.011364
Median: at our_attack_min_eigenvalue n_at 5  e 675 | val loss 2.2521 val acc 24.2695 best val_acc 48.011364
Median: at our_attack_min_eigenvalue n_at 5  e 700 | val loss 1.7963 val acc 33.5633 best val_acc 48.011364
Median: at our_attack_min_eigenvalue n_at 5  e 725 | val loss 1.7554 val acc 38.9205 best val_acc 48.011364
Median: at our_attack_min_eigenvalue n_at 5  e 750 | val loss 1.5480 val acc 46.8750 best val_acc 48.011364
Median: at our_attack_min_eigenvalue n_at 5  e 775 | val loss 1.6917 val acc 39.9351 best val_acc 50.385552
Median: at our_attack_min_eigenvalue n_at 5  e 800 | val loss 1.6385 val acc 42.9586 best val_acc 50.385552
Median: at our_attack_min_eigenvalue n_at 5  e 825 | val loss 1.7534 val acc 40.0568 best val_acc 50.385552
Median: at our_attack_min_eigenvalue n_at 5  e 850 | val loss 1.6761 val acc 39.6510 best val_acc 50.385552
Median: at our_attack_min_eigenvalue n_at 5  e 875 | val loss 1.6946 val acc 37.9667 best val_acc 52.130682
Median: at our_attack_min_eigenvalue n_at 5  e 900 | val loss 1.4470 val acc 47.0170 best val_acc 52.353896
Median: at our_attack_min_eigenvalue n_at 5  e 925 | val loss 1.5682 val acc 42.7760 best val_acc 52.861201
Median: at our_attack_min_eigenvalue n_at 5  e 950 | val loss 1.6761 val acc 41.3555 best val_acc 52.861201
Median: at our_attack_min_eigenvalue n_at 5  e 975 | val loss 1.3437 val acc 51.6437 best val_acc 53.530844
val loss 673908.216518 too high
change new seed now epoch: 986
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
tr_mean: at our_attack_min_eigenvalue n_at 5  e 0 | val loss 2.3023 val acc 11.0795 best val_acc 11.079545
tr_mean: at our_attack_min_eigenvalue n_at 5  e 25 | val loss 2.3038 val acc 9.7403 best val_acc 22.463474
tr_mean: at our_attack_min_eigenvalue n_at 5  e 50 | val loss 2.1742 val acc 15.4018 best val_acc 22.463474
tr_mean: at our_attack_min_eigenvalue n_at 5  e 75 | val loss 2.2328 val acc 10.8766 best val_acc 22.463474
tr_mean: at our_attack_min_eigenvalue n_at 5  e 100 | val loss 2.0832 val acc 19.2979 best val_acc 22.463474
tr_mean: at our_attack_min_eigenvalue n_at 5  e 125 | val loss 2.0917 val acc 19.5211 best val_acc 24.756494
tr_mean: at our_attack_min_eigenvalue n_at 5  e 150 | val loss 1.9241 val acc 27.4554 best val_acc 27.455357
tr_mean: at our_attack_min_eigenvalue n_at 5  e 175 | val loss 1.9835 val acc 24.1680 best val_acc 30.438312
tr_mean: at our_attack_min_eigenvalue n_at 5  e 200 | val loss 1.8380 val acc 32.8125 best val_acc 32.812500
tr_mean: at our_attack_min_eigenvalue n_at 5  e 225 | val loss 2.0534 val acc 23.2346 best val_acc 35.349026
tr_mean: at our_attack_min_eigenvalue n_at 5  e 250 | val loss 2.0019 val acc 29.9310 best val_acc 35.633117
tr_mean: at our_attack_min_eigenvalue n_at 5  e 275 | val loss 1.8415 val acc 31.8994 best val_acc 38.331981
tr_mean: at our_attack_min_eigenvalue n_at 5  e 300 | val loss 1.8391 val acc 32.2646 best val_acc 39.813312
tr_mean: at our_attack_min_eigenvalue n_at 5  e 325 | val loss 1.6095 val acc 41.7817 best val_acc 42.288961
tr_mean: at our_attack_min_eigenvalue n_at 5  e 350 | val loss 1.6302 val acc 40.0771 best val_acc 43.851461
tr_mean: at our_attack_min_eigenvalue n_at 5  e 375 | val loss 1.6331 val acc 40.7670 best val_acc 43.851461
tr_mean: at our_attack_min_eigenvalue n_at 5  e 400 | val loss 1.5415 val acc 43.3847 best val_acc 45.900974
tr_mean: at our_attack_min_eigenvalue n_at 5  e 425 | val loss 1.6441 val acc 39.7119 best val_acc 46.773539
tr_mean: at our_attack_min_eigenvalue n_at 5  e 450 | val loss 1.5566 val acc 41.4976 best val_acc 47.909903
tr_mean: at our_attack_min_eigenvalue n_at 5  e 475 | val loss 1.5528 val acc 43.2224 best val_acc 48.741883
tr_mean: at our_attack_min_eigenvalue n_at 5  e 500 | val loss 1.5711 val acc 43.8718 best val_acc 50.852273
tr_mean: at our_attack_min_eigenvalue n_at 5  e 525 | val loss 1.5323 val acc 43.8920 best val_acc 50.852273
tr_mean: at our_attack_min_eigenvalue n_at 5  e 550 | val loss 1.6192 val acc 44.1964 best val_acc 51.663961
tr_mean: at our_attack_min_eigenvalue n_at 5  e 575 | val loss 1.3545 val acc 50.4870 best val_acc 52.597403
tr_mean: at our_attack_min_eigenvalue n_at 5  e 600 | val loss 1.4709 val acc 47.2606 best val_acc 54.058442
tr_mean: at our_attack_min_eigenvalue n_at 5  e 625 | val loss 1.5472 val acc 45.3734 best val_acc 54.890422
tr_mean: at our_attack_min_eigenvalue n_at 5  e 650 | val loss 1.3581 val acc 49.4724 best val_acc 54.890422
tr_mean: at our_attack_min_eigenvalue n_at 5  e 675 | val loss 1.3591 val acc 51.5828 best val_acc 54.890422
tr_mean: at our_attack_min_eigenvalue n_at 5  e 700 | val loss 1.1849 val acc 57.5487 best val_acc 57.548701
tr_mean: at our_attack_min_eigenvalue n_at 5  e 725 | val loss 1.3055 val acc 53.9773 best val_acc 57.548701
tr_mean: at our_attack_min_eigenvalue n_at 5  e 750 | val loss 1.1875 val acc 57.3255 best val_acc 57.711039
tr_mean: at our_attack_min_eigenvalue n_at 5  e 775 | val loss 1.8204 val acc 36.1201 best val_acc 58.887987
tr_mean: at our_attack_min_eigenvalue n_at 5  e 800 | val loss 1.3263 val acc 53.4903 best val_acc 58.887987
tr_mean: at our_attack_min_eigenvalue n_at 5  e 825 | val loss 1.3197 val acc 53.3685 best val_acc 58.887987
tr_mean: at our_attack_min_eigenvalue n_at 5  e 850 | val loss 1.1923 val acc 57.8937 best val_acc 59.030032
tr_mean: at our_attack_min_eigenvalue n_at 5  e 875 | val loss 1.3195 val acc 53.5106 best val_acc 59.030032
tr_mean: at our_attack_min_eigenvalue n_at 5  e 900 | val loss 1.3371 val acc 51.3799 best val_acc 59.679383
tr_mean: at our_attack_min_eigenvalue n_at 5  e 925 | val loss 1.5149 val acc 47.0576 best val_acc 62.439123
tr_mean: at our_attack_min_eigenvalue n_at 5  e 950 | val loss 1.2010 val acc 58.0763 best val_acc 62.439123
tr_mean: at our_attack_min_eigenvalue n_at 5  e 975 | val loss 1.3006 val acc 55.8847 best val_acc 62.439123
New learnin rate  0.25
tr_mean: at our_attack_min_eigenvalue n_at 5  e 1000 | val loss 1.2421 val acc 54.7687 best val_acc 62.439123
tr_mean: at our_attack_min_eigenvalue n_at 5  e 1025 | val loss 1.0572 val acc 63.3523 best val_acc 65.016234
tr_mean: at our_attack_min_eigenvalue n_at 5  e 1050 | val loss 1.1096 val acc 62.2565 best val_acc 65.016234
tr_mean: at our_attack_min_eigenvalue n_at 5  e 1075 | val loss 1.1229 val acc 62.4594 best val_acc 65.117695
tr_mean: at our_attack_min_eigenvalue n_at 5  e 1100 | val loss 1.0710 val acc 63.7378 best val_acc 65.117695
tr_mean: at our_attack_min_eigenvalue n_at 5  e 1125 | val loss 1.1835 val acc 60.9375 best val_acc 65.178571
tr_mean: at our_attack_min_eigenvalue n_at 5  e 1150 | val loss 1.0983 val acc 63.9610 best val_acc 65.178571
tr_mean: at our_attack_min_eigenvalue n_at 5  e 1175 | val loss 1.0553 val acc 63.2102 best val_acc 65.178571
tr_mean: at our_attack_min_eigenvalue n_at 5  e 1199 | val loss 1.2431 val acc 60.2476 best val_acc 65.178571
tr_mean: at our_attack_min_eigenvalue n_at 5  e 1200 | val loss 1.3845 val acc 58.7662 best val_acc 65.178571
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
FedAvg: at our_attack_min_eigenvalue n_at 5  e 0 | val loss 2.3023 val acc 11.2013 best val_acc 11.201299
FedAvg: at our_attack_min_eigenvalue n_at 5  e 25 | val loss 2.3035 val acc 9.7808 best val_acc 20.129870
FedAvg: at our_attack_min_eigenvalue n_at 5  e 50 | val loss 2.3353 val acc 16.7817 best val_acc 21.428571
FedAvg: at our_attack_min_eigenvalue n_at 5  e 75 | val loss 2.1640 val acc 17.7151 best val_acc 21.428571
FedAvg: at our_attack_min_eigenvalue n_at 5  e 100 | val loss 2.0980 val acc 19.5008 best val_acc 21.428571
FedAvg: at our_attack_min_eigenvalue n_at 5  e 125 | val loss 2.0759 val acc 18.6080 best val_acc 22.666396
FedAvg: at our_attack_min_eigenvalue n_at 5  e 150 | val loss 1.9458 val acc 23.5593 best val_acc 28.287338
FedAvg: at our_attack_min_eigenvalue n_at 5  e 175 | val loss 1.9832 val acc 25.5276 best val_acc 30.093344
FedAvg: at our_attack_min_eigenvalue n_at 5  e 200 | val loss 1.9214 val acc 29.1193 best val_acc 30.742695
FedAvg: at our_attack_min_eigenvalue n_at 5  e 225 | val loss 1.7394 val acc 34.3953 best val_acc 36.120130
FedAvg: at our_attack_min_eigenvalue n_at 5  e 250 | val loss 1.7284 val acc 35.9781 best val_acc 36.120130
FedAvg: at our_attack_min_eigenvalue n_at 5  e 275 | val loss 1.7960 val acc 33.9894 best val_acc 38.392857
FedAvg: at our_attack_min_eigenvalue n_at 5  e 300 | val loss 1.8619 val acc 33.6039 best val_acc 39.407468
FedAvg: at our_attack_min_eigenvalue n_at 5  e 325 | val loss 1.8660 val acc 30.7630 best val_acc 41.314935
FedAvg: at our_attack_min_eigenvalue n_at 5  e 350 | val loss 1.6704 val acc 38.8596 best val_acc 41.578734
FedAvg: at our_attack_min_eigenvalue n_at 5  e 375 | val loss 1.6843 val acc 38.8393 best val_acc 44.500812
FedAvg: at our_attack_min_eigenvalue n_at 5  e 400 | val loss 1.5417 val acc 44.7037 best val_acc 46.489448
FedAvg: at our_attack_min_eigenvalue n_at 5  e 425 | val loss 1.5839 val acc 41.4773 best val_acc 46.489448
FedAvg: at our_attack_min_eigenvalue n_at 5  e 450 | val loss 1.7413 val acc 38.6567 best val_acc 47.341721
FedAvg: at our_attack_min_eigenvalue n_at 5  e 475 | val loss 1.4253 val acc 47.5244 best val_acc 49.025974
FedAvg: at our_attack_min_eigenvalue n_at 5  e 500 | val loss 1.5157 val acc 45.4748 best val_acc 49.025974
FedAvg: at our_attack_min_eigenvalue n_at 5  e 525 | val loss 1.3727 val acc 50.6291 best val_acc 50.629058
FedAvg: at our_attack_min_eigenvalue n_at 5  e 550 | val loss 1.3311 val acc 51.7248 best val_acc 52.252435
FedAvg: at our_attack_min_eigenvalue n_at 5  e 575 | val loss 1.3765 val acc 50.1623 best val_acc 53.591721
FedAvg: at our_attack_min_eigenvalue n_at 5  e 600 | val loss 1.3744 val acc 50.3247 best val_acc 53.754058
FedAvg: at our_attack_min_eigenvalue n_at 5  e 625 | val loss 1.4972 val acc 48.4172 best val_acc 53.754058
FedAvg: at our_attack_min_eigenvalue n_at 5  e 650 | val loss 1.4588 val acc 48.7216 best val_acc 54.241071
FedAvg: at our_attack_min_eigenvalue n_at 5  e 675 | val loss 1.4227 val acc 50.7711 best val_acc 57.589286
FedAvg: at our_attack_min_eigenvalue n_at 5  e 700 | val loss 1.4000 val acc 50.1218 best val_acc 57.589286
FedAvg: at our_attack_min_eigenvalue n_at 5  e 725 | val loss 2.2940 val acc 10.4302 best val_acc 57.589286
FedAvg: at our_attack_min_eigenvalue n_at 5  e 750 | val loss 2.2541 val acc 20.7792 best val_acc 57.589286
FedAvg: at our_attack_min_eigenvalue n_at 5  e 775 | val loss 1.5634 val acc 46.3271 best val_acc 57.589286
FedAvg: at our_attack_min_eigenvalue n_at 5  e 800 | val loss 1.4326 val acc 49.1071 best val_acc 57.589286
FedAvg: at our_attack_min_eigenvalue n_at 5  e 825 | val loss 1.2843 val acc 55.3977 best val_acc 57.589286
FedAvg: at our_attack_min_eigenvalue n_at 5  e 850 | val loss 1.3818 val acc 53.0235 best val_acc 57.589286
FedAvg: at our_attack_min_eigenvalue n_at 5  e 875 | val loss 1.2904 val acc 54.4237 best val_acc 57.589286
FedAvg: at our_attack_min_eigenvalue n_at 5  e 900 | val loss 1.4910 val acc 46.0024 best val_acc 57.934253
FedAvg: at our_attack_min_eigenvalue n_at 5  e 925 | val loss 1.3549 val acc 52.6786 best val_acc 60.004058
FedAvg: at our_attack_min_eigenvalue n_at 5  e 950 | val loss 1.3427 val acc 54.6469 best val_acc 60.004058
FedAvg: at our_attack_min_eigenvalue n_at 5  e 975 | val loss 1.4100 val acc 50.0000 best val_acc 60.592532
New learnin rate  0.25
FedAvg: at our_attack_min_eigenvalue n_at 5  e 1000 | val loss 1.0603 val acc 62.9058 best val_acc 62.905844
FedAvg: at our_attack_min_eigenvalue n_at 5  e 1025 | val loss 1.0601 val acc 63.4943 best val_acc 63.758117
FedAvg: at our_attack_min_eigenvalue n_at 5  e 1050 | val loss 1.0898 val acc 62.0536 best val_acc 63.758117
FedAvg: at our_attack_min_eigenvalue n_at 5  e 1075 | val loss 1.0707 val acc 63.4943 best val_acc 63.940747
FedAvg: at our_attack_min_eigenvalue n_at 5  e 1100 | val loss 1.1827 val acc 58.9083 best val_acc 63.940747
FedAvg: at our_attack_min_eigenvalue n_at 5  e 1125 | val loss 1.1502 val acc 60.5925 best val_acc 63.940747
FedAvg: at our_attack_min_eigenvalue n_at 5  e 1150 | val loss 1.0865 val acc 62.9261 best val_acc 63.940747
FedAvg: at our_attack_min_eigenvalue n_at 5  e 1175 | val loss 1.1450 val acc 61.2622 best val_acc 64.001623
FedAvg: at our_attack_min_eigenvalue n_at 5  e 1199 | val loss 1.1337 val acc 62.1347 best val_acc 64.001623
FedAvg: at our_attack_min_eigenvalue n_at 5  e 1200 | val loss 1.1182 val acc 62.2362 best val_acc 64.001623
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 0 | val loss 2.3023 val acc 11.2622 best val_acc 11.262175
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 25 | val loss 2.3134 val acc 9.7403 best val_acc 20.860390
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 50 | val loss 2.2099 val acc 19.7849 best val_acc 20.860390
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 75 | val loss 2.2709 val acc 14.7930 best val_acc 20.860390
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 100 | val loss 2.1112 val acc 19.8255 best val_acc 22.889610
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 125 | val loss 2.2724 val acc 13.3117 best val_acc 23.701299
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 150 | val loss 1.9580 val acc 25.3856 best val_acc 25.933442
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 175 | val loss 2.1542 val acc 21.8547 best val_acc 30.032468
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 200 | val loss 1.9284 val acc 28.1859 best val_acc 30.073052
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 225 | val loss 2.0178 val acc 28.1859 best val_acc 33.908279
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 250 | val loss 1.7886 val acc 34.8823 best val_acc 35.592532
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 275 | val loss 1.8106 val acc 32.9140 best val_acc 37.560877
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 300 | val loss 1.8548 val acc 34.3141 best val_acc 39.590097
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 325 | val loss 1.6618 val acc 39.6916 best val_acc 41.436688
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 350 | val loss 1.6863 val acc 38.9002 best val_acc 42.775974
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 375 | val loss 1.6700 val acc 39.5698 best val_acc 44.663149
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 400 | val loss 1.7669 val acc 34.9026 best val_acc 45.109578
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 425 | val loss 1.4561 val acc 47.6055 best val_acc 47.605519
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 450 | val loss 1.6813 val acc 40.2394 best val_acc 48.193994
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 475 | val loss 1.4158 val acc 48.9651 best val_acc 49.756494
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 500 | val loss 1.4488 val acc 48.4781 best val_acc 50.527597
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 525 | val loss 1.4377 val acc 48.5998 best val_acc 50.750812
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 550 | val loss 1.4693 val acc 47.7070 best val_acc 52.293019
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 575 | val loss 1.3589 val acc 49.8985 best val_acc 55.377435
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 600 | val loss 1.4642 val acc 47.7679 best val_acc 55.377435
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 625 | val loss 1.6808 val acc 39.9554 best val_acc 55.377435
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 650 | val loss 1.4264 val acc 50.0609 best val_acc 56.026786
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 675 | val loss 1.2921 val acc 53.2468 best val_acc 56.026786
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 700 | val loss 1.2376 val acc 56.0471 best val_acc 56.574675
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 725 | val loss 1.2703 val acc 54.5252 best val_acc 56.574675
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 750 | val loss 1.3343 val acc 53.1250 best val_acc 56.574675
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 775 | val loss 1.1498 val acc 59.1518 best val_acc 59.151786
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 800 | val loss 2.1315 val acc 28.5511 best val_acc 59.151786
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 825 | val loss 1.6203 val acc 41.9034 best val_acc 59.151786
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 850 | val loss 1.3775 val acc 52.5974 best val_acc 59.151786
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 875 | val loss 1.4564 val acc 51.5625 best val_acc 59.151786
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 900 | val loss 1.4674 val acc 49.6144 best val_acc 59.151786
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 925 | val loss 1.1648 val acc 59.2330 best val_acc 59.232955
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 950 | val loss 1.3004 val acc 53.8961 best val_acc 59.232955
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 975 | val loss 1.3331 val acc 54.3222 best val_acc 60.896916
New learnin rate  0.25
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 1000 | val loss 2.6897 val acc 9.6185 best val_acc 61.525974
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 1025 | val loss 1.5339 val acc 47.4229 best val_acc 61.525974
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 1050 | val loss 1.1809 val acc 58.6851 best val_acc 61.525974
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 1075 | val loss 1.1582 val acc 60.3490 best val_acc 61.525974
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 1100 | val loss 1.0958 val acc 62.3782 best val_acc 62.378247
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 1125 | val loss 1.1330 val acc 60.4911 best val_acc 62.885552
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 1150 | val loss 1.1289 val acc 61.9115 best val_acc 63.108766
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 1175 | val loss 1.2458 val acc 58.8068 best val_acc 63.534903
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 1199 | val loss 1.0887 val acc 62.3985 best val_acc 63.534903
Norm_bounding: at our_attack_min_eigenvalue n_at 5  e 1200 | val loss 1.1393 val acc 61.4854 best val_acc 63.534903
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 13 e 0 | val loss 2.3023 val acc 11.0998 best val_acc 11.099838
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 14 e 25 | val loss 2.2901 val acc 10.9781 best val_acc 18.384740
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 14 e 50 | val loss 2.1410 val acc 19.0950 best val_acc 21.225649
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 75 | val loss 2.2736 val acc 12.6015 best val_acc 21.225649
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 100 | val loss 2.3292 val acc 12.6218 best val_acc 21.225649
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 125 | val loss 2.3243 val acc 7.9545 best val_acc 21.225649
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 150 | val loss 2.1980 val acc 18.1615 best val_acc 21.225649
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 175 | val loss 2.1638 val acc 18.5674 best val_acc 21.225649
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 8 e 200 | val loss 2.3140 val acc 11.0795 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 4 e 225 | val loss 2.3681 val acc 9.7606 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 2 e 250 | val loss 2.3286 val acc 9.9229 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 7 e 275 | val loss 2.3477 val acc 11.2419 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 300 | val loss 2.3462 val acc 12.1550 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 12 e 325 | val loss 2.2741 val acc 11.8912 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 350 | val loss 2.1688 val acc 17.2687 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 9 e 375 | val loss 2.3159 val acc 9.9838 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 400 | val loss 2.3015 val acc 12.7232 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 425 | val loss 2.3002 val acc 13.1696 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 450 | val loss 2.2599 val acc 13.4740 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 14 e 475 | val loss 2.3774 val acc 14.1234 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 500 | val loss 2.2366 val acc 19.9067 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 13 e 525 | val loss 2.1396 val acc 17.0049 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 550 | val loss 2.1561 val acc 16.4773 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 575 | val loss 2.2939 val acc 11.7492 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 13 e 600 | val loss 2.3332 val acc 11.5869 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 12 e 625 | val loss 2.2977 val acc 12.7232 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 12 e 650 | val loss 2.3500 val acc 9.7606 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 5 e 675 | val loss 2.3748 val acc 9.7403 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 7 e 700 | val loss 2.3501 val acc 12.5000 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 11 e 725 | val loss 2.2490 val acc 15.7265 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 13 e 750 | val loss 2.2268 val acc 18.1209 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 14 e 775 | val loss 2.2583 val acc 18.9935 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 9 e 800 | val loss 2.2106 val acc 16.9440 best val_acc 22.443182
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 14 e 825 | val loss 2.1946 val acc 21.2662 best val_acc 24.127435
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 850 | val loss 2.2008 val acc 16.5787 best val_acc 24.127435
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 2 e 875 | val loss 2.3019 val acc 18.7906 best val_acc 24.127435
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 900 | val loss 2.2338 val acc 16.5179 best val_acc 24.127435
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 14 e 925 | val loss 2.3182 val acc 18.3644 best val_acc 24.127435
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 4 e 950 | val loss 2.2027 val acc 17.2484 best val_acc 24.127435
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 975 | val loss 2.3295 val acc 16.0511 best val_acc 24.127435
New learnin rate  0.25
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 5 e 1000 | val loss 2.2525 val acc 14.6510 best val_acc 24.127435
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 11 e 1025 | val loss 2.1453 val acc 22.8693 best val_acc 24.431818
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 1050 | val loss 2.1731 val acc 19.3385 best val_acc 26.116071
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 1075 | val loss 2.4557 val acc 10.3287 best val_acc 26.116071
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 2 e 1100 | val loss 2.1674 val acc 18.4050 best val_acc 26.116071
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 1125 | val loss 2.0678 val acc 23.5390 best val_acc 26.116071
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 15 e 1150 | val loss 2.0927 val acc 20.6575 best val_acc 26.116071
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 10 e 1175 | val loss 2.1315 val acc 18.6891 best val_acc 26.116071
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 7 e 1199 | val loss 2.3290 val acc 15.2597 best val_acc 26.116071
Multi_krum: at our_attack_cos_second n_at 15 n_mal_sel 4 e 1200 | val loss 2.1649 val acc 22.1997 best val_acc 26.116071
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 0 | val loss 2.3023 val acc 10.6128 best val_acc 10.612825
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 25 | val loss 2.2994 val acc 12.2768 best val_acc 19.784903
krum: at our_attack_cos_second n_at 15 n_mal_sel 0 e 50 | val loss 2.2577 val acc 16.2135 best val_acc 19.784903
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 75 | val loss 2.3132 val acc 9.7403 best val_acc 20.129870
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 100 | val loss 2.2852 val acc 10.4708 best val_acc 20.129870
krum: at our_attack_cos_second n_at 15 n_mal_sel 0 e 125 | val loss 2.2325 val acc 13.5755 best val_acc 20.129870
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 150 | val loss 2.0693 val acc 18.7297 best val_acc 20.129870
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 175 | val loss 2.2367 val acc 15.7873 best val_acc 21.692370
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 200 | val loss 2.1684 val acc 18.4456 best val_acc 21.692370
krum: at our_attack_cos_second n_at 15 n_mal_sel 0 e 225 | val loss 2.1047 val acc 18.3847 best val_acc 21.692370
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 250 | val loss 2.0547 val acc 19.2370 best val_acc 21.692370
krum: at our_attack_cos_second n_at 15 n_mal_sel 0 e 275 | val loss 2.3662 val acc 9.8011 best val_acc 21.692370
krum: at our_attack_cos_second n_at 15 n_mal_sel 0 e 300 | val loss 2.2350 val acc 13.2305 best val_acc 21.692370
krum: at our_attack_cos_second n_at 15 n_mal_sel 0 e 325 | val loss 2.2440 val acc 15.3206 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 350 | val loss 2.3900 val acc 10.2273 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 375 | val loss 2.2012 val acc 14.9959 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 0 e 400 | val loss 2.1731 val acc 15.6250 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 0 e 425 | val loss 2.4012 val acc 8.3401 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 450 | val loss 2.1840 val acc 14.8945 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 475 | val loss 2.3025 val acc 9.7606 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 500 | val loss 2.2890 val acc 12.0739 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 525 | val loss 2.3069 val acc 9.7403 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 550 | val loss 2.3036 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 575 | val loss 2.3035 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 600 | val loss 2.3035 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 625 | val loss 2.3034 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 650 | val loss 2.3035 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 675 | val loss 2.3036 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 700 | val loss 2.3036 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 725 | val loss 2.3034 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 750 | val loss 2.3035 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 775 | val loss 2.3036 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 800 | val loss 2.3037 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 825 | val loss 2.3033 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 850 | val loss 2.3035 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 875 | val loss 2.3037 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 900 | val loss 2.3039 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 925 | val loss 2.3033 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 950 | val loss 2.3036 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 975 | val loss 2.3039 val acc 9.6185 best val_acc 21.793831
New learnin rate  0.25
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 1000 | val loss 2.3038 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 1025 | val loss 2.3034 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 1050 | val loss 2.3035 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 1075 | val loss 2.3037 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 1100 | val loss 2.3038 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 1125 | val loss 2.3033 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 1150 | val loss 2.3035 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 1175 | val loss 2.3037 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 1199 | val loss 2.3037 val acc 9.6185 best val_acc 21.793831
krum: at our_attack_cos_second n_at 15 n_mal_sel 1 e 1200 | val loss 2.3039 val acc 9.6185 best val_acc 21.793831
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 13 e 0 | val loss 2.3023 val acc 10.6128 best val_acc 10.612825
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 15 e 25 | val loss 2.3065 val acc 11.3433 best val_acc 19.663149
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 5 e 50 | val loss 2.2378 val acc 16.9237 best val_acc 19.663149
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 11 e 75 | val loss 2.2317 val acc 17.0860 best val_acc 19.663149
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 6 e 100 | val loss 2.2439 val acc 11.9724 best val_acc 19.663149
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 13 e 125 | val loss 2.2997 val acc 14.7930 best val_acc 19.784903
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 15 e 150 | val loss 2.3004 val acc 10.4911 best val_acc 21.387987
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 15 e 175 | val loss 2.2986 val acc 12.3377 best val_acc 21.387987
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 15 e 200 | val loss 2.3197 val acc 7.9140 best val_acc 21.387987
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 15 e 225 | val loss 2.2711 val acc 8.9286 best val_acc 21.387987
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 15 e 250 | val loss 2.2561 val acc 15.9903 best val_acc 21.387987
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 13 e 275 | val loss 2.2317 val acc 18.9326 best val_acc 21.387987
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 7 e 300 | val loss 2.2896 val acc 13.5755 best val_acc 21.387987
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 12 e 325 | val loss 2.2972 val acc 9.5982 best val_acc 21.387987
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 15 e 350 | val loss 2.2684 val acc 10.4505 best val_acc 21.387987
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 15 e 375 | val loss 2.2400 val acc 14.0016 best val_acc 21.387987
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 15 e 400 | val loss 2.2600 val acc 12.5812 best val_acc 21.387987
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 15 e 425 | val loss 2.2530 val acc 13.2914 best val_acc 21.387987
Bulyan: at our_attack_cos_second n_at 15 n_mal_sel 13 e 450 | val loss 2.2494 val acc 13.5755 best val_acc 21.387987
val loss 1231.067355 too high
change new seed now epoch: 455
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Median: at our_attack_cos_second n_at 15  e 0 | val loss 2.3023 val acc 10.3287 best val_acc 10.328734
Median: at our_attack_cos_second n_at 15  e 25 | val loss 2.2915 val acc 11.2013 best val_acc 19.805195
Median: at our_attack_cos_second n_at 15  e 50 | val loss 2.2829 val acc 11.6883 best val_acc 20.129870
Median: at our_attack_cos_second n_at 15  e 75 | val loss 2.2451 val acc 14.8742 best val_acc 20.860390
Median: at our_attack_cos_second n_at 15  e 100 | val loss 2.2069 val acc 18.0398 best val_acc 20.860390
Median: at our_attack_cos_second n_at 15  e 125 | val loss 2.1377 val acc 18.5471 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 150 | val loss 2.2384 val acc 16.7208 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 175 | val loss 2.2201 val acc 13.9610 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 200 | val loss 2.2199 val acc 14.2045 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 225 | val loss 2.3419 val acc 10.2476 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 250 | val loss 2.3009 val acc 14.3466 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 275 | val loss 2.3235 val acc 9.9635 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 300 | val loss 2.3073 val acc 9.9635 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 325 | val loss 2.3164 val acc 9.9635 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 350 | val loss 2.3393 val acc 9.4968 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 375 | val loss 2.2628 val acc 12.7029 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 400 | val loss 2.3643 val acc 10.2476 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 425 | val loss 2.3033 val acc 10.2476 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 450 | val loss 2.3027 val acc 9.5982 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 475 | val loss 2.3027 val acc 9.5982 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 500 | val loss 2.3028 val acc 9.6185 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 525 | val loss 2.3027 val acc 9.6185 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 550 | val loss 2.3027 val acc 9.6185 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 575 | val loss 2.3027 val acc 10.2881 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 600 | val loss 2.3031 val acc 9.5779 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 625 | val loss 2.3026 val acc 10.2476 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 650 | val loss 2.3026 val acc 9.6185 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 675 | val loss 2.3028 val acc 9.5373 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 700 | val loss 2.3037 val acc 9.5982 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 725 | val loss 2.3025 val acc 10.2476 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 750 | val loss 2.3027 val acc 10.3896 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 775 | val loss 2.3030 val acc 10.2881 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 800 | val loss 2.3049 val acc 9.6185 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 825 | val loss 2.7179 val acc 9.7403 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 850 | val loss 2.3070 val acc 10.2679 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 875 | val loss 2.2287 val acc 16.4773 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 900 | val loss 2.2982 val acc 10.1664 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 925 | val loss 2.2816 val acc 11.4245 best val_acc 22.585227
Median: at our_attack_cos_second n_at 15  e 950 | val loss 2.2094 val acc 18.8312 best val_acc 22.585227
val loss 4415.714898 too high
change new seed now epoch: 970
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
tr_mean: at our_attack_cos_second n_at 15  e 0 | val loss 2.3023 val acc 10.9578 best val_acc 10.957792
tr_mean: at our_attack_cos_second n_at 15  e 25 | val loss 2.3284 val acc 9.7606 best val_acc 21.083604
tr_mean: at our_attack_cos_second n_at 15  e 50 | val loss 2.2685 val acc 11.8709 best val_acc 21.266234
tr_mean: at our_attack_cos_second n_at 15  e 75 | val loss 2.2602 val acc 18.0804 best val_acc 21.266234
tr_mean: at our_attack_cos_second n_at 15  e 100 | val loss 2.2968 val acc 12.0739 best val_acc 21.266234
tr_mean: at our_attack_cos_second n_at 15  e 125 | val loss 2.1405 val acc 19.6429 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 150 | val loss 2.2923 val acc 12.8247 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 175 | val loss 2.2707 val acc 11.6680 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 200 | val loss 2.1966 val acc 15.7873 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 225 | val loss 3.6297 val acc 15.2394 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 250 | val loss 2.2945 val acc 10.6940 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 275 | val loss 2.3022 val acc 9.9635 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 300 | val loss 2.3031 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 325 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 350 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 375 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 400 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 425 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 450 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 475 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 500 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 525 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 550 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 575 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 600 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 625 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 650 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 675 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 700 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 725 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 750 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 775 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 800 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 825 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 850 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 875 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 900 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 925 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 950 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 975 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
New learnin rate  0.25
tr_mean: at our_attack_cos_second n_at 15  e 1000 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 1025 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 1050 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 1075 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 1100 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 1125 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 1150 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 1175 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 1199 | val loss 2.3028 val acc 9.6185 best val_acc 23.092532
tr_mean: at our_attack_cos_second n_at 15  e 1200 | val loss 2.3029 val acc 9.6185 best val_acc 23.092532
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
FedAvg: at our_attack_cos_second n_at 15  e 0 | val loss 2.3023 val acc 11.1810 best val_acc 11.181006
FedAvg: at our_attack_cos_second n_at 15  e 25 | val loss 2.2948 val acc 12.9464 best val_acc 21.448864
FedAvg: at our_attack_cos_second n_at 15  e 50 | val loss 2.2017 val acc 18.0195 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 75 | val loss 2.2978 val acc 14.3669 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 100 | val loss 2.3067 val acc 13.4740 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 125 | val loss 2.2920 val acc 11.6680 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 150 | val loss 2.2135 val acc 17.4107 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 175 | val loss 2.3010 val acc 10.9578 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 200 | val loss 2.3164 val acc 10.5722 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 225 | val loss 3.0078 val acc 14.3263 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 250 | val loss 2.2248 val acc 17.1875 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 275 | val loss 2.3321 val acc 9.8214 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 300 | val loss 2.3371 val acc 10.0852 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 325 | val loss 2.3176 val acc 9.7403 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 350 | val loss 2.2831 val acc 15.1380 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 375 | val loss 2.3015 val acc 14.7727 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 400 | val loss 2.2974 val acc 10.7143 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 425 | val loss 2.2866 val acc 9.9635 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 450 | val loss 2.3084 val acc 9.7403 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 475 | val loss 2.3017 val acc 11.4042 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 500 | val loss 2.3056 val acc 9.7403 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 525 | val loss 2.2910 val acc 14.1234 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 550 | val loss 2.2954 val acc 15.0365 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 575 | val loss 2.3182 val acc 10.0852 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 600 | val loss 2.2293 val acc 15.0568 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 625 | val loss 2.2004 val acc 15.1380 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 650 | val loss 2.3437 val acc 9.7403 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 675 | val loss 2.2655 val acc 18.2224 best val_acc 22.402597
FedAvg: at our_attack_cos_second n_at 15  e 700 | val loss 2.2463 val acc 14.5901 best val_acc 22.625812
FedAvg: at our_attack_cos_second n_at 15  e 725 | val loss 2.0983 val acc 20.4951 best val_acc 22.625812
FedAvg: at our_attack_cos_second n_at 15  e 750 | val loss 2.0770 val acc 21.5097 best val_acc 22.666396
FedAvg: at our_attack_cos_second n_at 15  e 775 | val loss 2.1080 val acc 22.3823 best val_acc 22.666396
FedAvg: at our_attack_cos_second n_at 15  e 800 | val loss 2.4122 val acc 14.1843 best val_acc 25.040584
FedAvg: at our_attack_cos_second n_at 15  e 825 | val loss 2.3192 val acc 10.4708 best val_acc 25.040584
FedAvg: at our_attack_cos_second n_at 15  e 850 | val loss 2.2993 val acc 12.7638 best val_acc 25.040584
FedAvg: at our_attack_cos_second n_at 15  e 875 | val loss 2.1525 val acc 19.0138 best val_acc 25.040584
FedAvg: at our_attack_cos_second n_at 15  e 900 | val loss 2.1829 val acc 18.8718 best val_acc 25.040584
FedAvg: at our_attack_cos_second n_at 15  e 925 | val loss 2.1304 val acc 19.6023 best val_acc 25.040584
FedAvg: at our_attack_cos_second n_at 15  e 950 | val loss 2.1730 val acc 20.2313 best val_acc 25.040584
FedAvg: at our_attack_cos_second n_at 15  e 975 | val loss 2.3005 val acc 15.1583 best val_acc 25.040584
New learnin rate  0.25
FedAvg: at our_attack_cos_second n_at 15  e 1000 | val loss 2.3389 val acc 10.7143 best val_acc 25.040584
FedAvg: at our_attack_cos_second n_at 15  e 1025 | val loss 2.1305 val acc 19.6429 best val_acc 25.040584
FedAvg: at our_attack_cos_second n_at 15  e 1050 | val loss 2.1455 val acc 22.0576 best val_acc 27.374188
FedAvg: at our_attack_cos_second n_at 15  e 1075 | val loss 2.0444 val acc 25.1015 best val_acc 29.606331
FedAvg: at our_attack_cos_second n_at 15  e 1100 | val loss 2.0810 val acc 19.4196 best val_acc 29.606331
FedAvg: at our_attack_cos_second n_at 15  e 1125 | val loss 2.2728 val acc 16.5990 best val_acc 30.905032
FedAvg: at our_attack_cos_second n_at 15  e 1150 | val loss 1.9124 val acc 28.5511 best val_acc 30.905032
FedAvg: at our_attack_cos_second n_at 15  e 1175 | val loss 1.9411 val acc 27.4148 best val_acc 30.905032
FedAvg: at our_attack_cos_second n_at 15  e 1199 | val loss 2.1792 val acc 20.6778 best val_acc 32.670455
FedAvg: at our_attack_cos_second n_at 15  e 1200 | val loss 2.2254 val acc 17.4513 best val_acc 32.670455
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Norm_bounding: at our_attack_cos_second n_at 15  e 0 | val loss 2.3023 val acc 11.3433 best val_acc 11.343344
Norm_bounding: at our_attack_cos_second n_at 15  e 25 | val loss 2.3063 val acc 9.5982 best val_acc 22.280844
Norm_bounding: at our_attack_cos_second n_at 15  e 50 | val loss 2.2858 val acc 11.4042 best val_acc 22.280844
Norm_bounding: at our_attack_cos_second n_at 15  e 75 | val loss 2.2715 val acc 12.3580 best val_acc 22.280844
Norm_bounding: at our_attack_cos_second n_at 15  e 100 | val loss 2.2928 val acc 11.0593 best val_acc 22.280844
Norm_bounding: at our_attack_cos_second n_at 15  e 125 | val loss 2.1457 val acc 16.3352 best val_acc 22.280844
Norm_bounding: at our_attack_cos_second n_at 15  e 150 | val loss 2.1264 val acc 20.2110 best val_acc 22.280844
Norm_bounding: at our_attack_cos_second n_at 15  e 175 | val loss 2.1044 val acc 22.1591 best val_acc 22.280844
Norm_bounding: at our_attack_cos_second n_at 15  e 200 | val loss 2.1265 val acc 22.1185 best val_acc 23.579545
Norm_bounding: at our_attack_cos_second n_at 15  e 225 | val loss 2.1602 val acc 18.9732 best val_acc 23.640422
Norm_bounding: at our_attack_cos_second n_at 15  e 250 | val loss 2.0350 val acc 24.1680 best val_acc 25.974026
Norm_bounding: at our_attack_cos_second n_at 15  e 275 | val loss 3.2671 val acc 10.4099 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 300 | val loss 2.2343 val acc 13.4943 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 325 | val loss 2.3013 val acc 14.2857 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 350 | val loss 2.3358 val acc 12.8653 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 375 | val loss 2.0937 val acc 20.6575 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 400 | val loss 2.1948 val acc 15.6047 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 425 | val loss 2.3041 val acc 10.5519 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 450 | val loss 2.2946 val acc 12.0130 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 475 | val loss 2.2700 val acc 11.9318 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 500 | val loss 2.3102 val acc 11.7492 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 525 | val loss 2.0455 val acc 19.1761 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 550 | val loss 2.2009 val acc 17.6542 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 575 | val loss 2.2862 val acc 9.0503 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 600 | val loss 2.1768 val acc 17.0455 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 625 | val loss 2.1321 val acc 20.2719 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 650 | val loss 2.3715 val acc 9.9229 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 675 | val loss 3.9903 val acc 14.1640 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 700 | val loss 2.2058 val acc 16.7005 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 725 | val loss 2.2465 val acc 16.2338 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 750 | val loss 2.2639 val acc 16.4570 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 775 | val loss 2.2969 val acc 12.4594 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 800 | val loss 2.0360 val acc 25.3856 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 825 | val loss 2.0144 val acc 23.8028 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 850 | val loss 1.9765 val acc 23.8636 best val_acc 28.246753
Norm_bounding: at our_attack_cos_second n_at 15  e 875 | val loss 2.4615 val acc 9.7606 best val_acc 29.200487
Norm_bounding: at our_attack_cos_second n_at 15  e 900 | val loss 2.1295 val acc 17.8166 best val_acc 29.200487
Norm_bounding: at our_attack_cos_second n_at 15  e 925 | val loss 2.0559 val acc 21.9156 best val_acc 29.200487
Norm_bounding: at our_attack_cos_second n_at 15  e 950 | val loss 2.3665 val acc 10.0244 best val_acc 29.200487
Norm_bounding: at our_attack_cos_second n_at 15  e 975 | val loss 2.2312 val acc 16.8222 best val_acc 29.200487
New learnin rate  0.25
Norm_bounding: at our_attack_cos_second n_at 15  e 1000 | val loss 2.1924 val acc 17.9180 best val_acc 29.200487
Norm_bounding: at our_attack_cos_second n_at 15  e 1025 | val loss 2.0271 val acc 25.8726 best val_acc 29.200487
Norm_bounding: at our_attack_cos_second n_at 15  e 1050 | val loss 2.0555 val acc 21.3068 best val_acc 29.200487
Norm_bounding: at our_attack_cos_second n_at 15  e 1075 | val loss 2.0487 val acc 23.3766 best val_acc 29.951299
Norm_bounding: at our_attack_cos_second n_at 15  e 1100 | val loss 2.3052 val acc 16.6599 best val_acc 31.676136
Norm_bounding: at our_attack_cos_second n_at 15  e 1125 | val loss 1.9233 val acc 26.0552 best val_acc 31.676136
Norm_bounding: at our_attack_cos_second n_at 15  e 1150 | val loss 1.8684 val acc 28.5917 best val_acc 31.676136
Norm_bounding: at our_attack_cos_second n_at 15  e 1175 | val loss 2.1999 val acc 18.6485 best val_acc 31.676136
Norm_bounding: at our_attack_cos_second n_at 15  e 1199 | val loss 1.9750 val acc 26.8872 best val_acc 31.676136
Norm_bounding: at our_attack_cos_second n_at 15  e 1200 | val loss 1.9931 val acc 24.8985 best val_acc 31.676136
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 0 | val loss 2.3023 val acc 11.2216 best val_acc 11.221591
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 25 | val loss 2.1587 val acc 21.2662 best val_acc 22.869318
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 50 | val loss 2.2813 val acc 11.6274 best val_acc 22.869318
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 75 | val loss 2.2996 val acc 11.9115 best val_acc 22.869318
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 100 | val loss 2.2986 val acc 11.6477 best val_acc 22.869318
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 125 | val loss 2.2536 val acc 13.1696 best val_acc 22.869318
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 150 | val loss 2.1845 val acc 19.4602 best val_acc 22.869318
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 175 | val loss 2.1625 val acc 18.3644 best val_acc 23.478084
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 200 | val loss 2.0305 val acc 23.1940 best val_acc 23.478084
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 225 | val loss 2.1093 val acc 18.6891 best val_acc 24.573864
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 250 | val loss 2.2238 val acc 13.7175 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 275 | val loss 2.2284 val acc 15.3815 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 300 | val loss 2.0663 val acc 17.6339 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 325 | val loss 2.1029 val acc 20.9213 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 350 | val loss 2.2805 val acc 12.9261 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 375 | val loss 2.2813 val acc 15.8076 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 400 | val loss 2.3077 val acc 12.7029 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 14 e 425 | val loss 2.2574 val acc 11.2013 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 450 | val loss 2.0828 val acc 19.6226 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 475 | val loss 3.1615 val acc 13.0276 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 500 | val loss 2.2429 val acc 17.5933 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 525 | val loss 2.0306 val acc 21.3271 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 550 | val loss 2.7376 val acc 11.0998 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 14 e 575 | val loss 2.2149 val acc 15.9091 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 600 | val loss 2.2415 val acc 14.9756 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 13 e 625 | val loss 3.2802 val acc 15.7265 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 650 | val loss 2.3067 val acc 11.2216 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 14 e 675 | val loss 2.3030 val acc 9.6185 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 700 | val loss 2.3030 val acc 9.6185 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 725 | val loss 2.3030 val acc 9.6185 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 750 | val loss 2.3030 val acc 9.6185 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 775 | val loss 2.3032 val acc 9.6185 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 14 e 800 | val loss 2.3036 val acc 9.8011 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 825 | val loss 2.2548 val acc 14.8742 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 850 | val loss 2.2956 val acc 10.2070 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 875 | val loss 2.6665 val acc 15.5438 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 900 | val loss 2.3034 val acc 9.5779 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 14 e 925 | val loss 2.3031 val acc 9.6185 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 950 | val loss 2.3032 val acc 9.6185 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 975 | val loss 2.5496 val acc 13.1696 best val_acc 25.771104
New learnin rate  0.25
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 1000 | val loss 2.2102 val acc 15.4018 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 1025 | val loss 2.0730 val acc 16.7005 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 1050 | val loss 2.2491 val acc 16.3352 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 1075 | val loss 2.1721 val acc 17.6339 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 1100 | val loss 2.1922 val acc 18.2833 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 1125 | val loss 2.0374 val acc 23.1331 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 1150 | val loss 2.2969 val acc 16.5787 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 1175 | val loss 2.0386 val acc 19.3588 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 14 e 1199 | val loss 2.1798 val acc 16.7817 best val_acc 25.771104
Multi_krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 1200 | val loss 2.1660 val acc 17.1875 best val_acc 25.771104
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 0 | val loss 2.3023 val acc 10.6737 best val_acc 10.673701
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 25 | val loss 2.2902 val acc 14.4886 best val_acc 18.587662
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 50 | val loss 2.2130 val acc 15.7468 best val_acc 18.648539
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 75 | val loss 2.3404 val acc 10.1055 best val_acc 18.831169
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 100 | val loss 2.2843 val acc 11.5057 best val_acc 18.871753
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 125 | val loss 2.3074 val acc 15.7468 best val_acc 19.054383
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 150 | val loss 2.1878 val acc 19.0341 best val_acc 19.074675
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 175 | val loss 2.2910 val acc 18.6080 best val_acc 22.889610
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 200 | val loss 2.3548 val acc 9.8620 best val_acc 22.889610
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 225 | val loss 2.2730 val acc 14.9148 best val_acc 22.889610
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 250 | val loss 2.3210 val acc 8.7459 best val_acc 22.889610
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 275 | val loss 2.2269 val acc 17.5933 best val_acc 22.889610
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 300 | val loss 2.1579 val acc 18.0601 best val_acc 22.889610
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 325 | val loss 2.3337 val acc 9.7403 best val_acc 22.889610
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 350 | val loss 2.2712 val acc 14.7727 best val_acc 22.889610
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 375 | val loss 2.1828 val acc 17.3904 best val_acc 22.889610
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 400 | val loss 2.3207 val acc 10.3084 best val_acc 22.889610
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 425 | val loss 2.3977 val acc 16.3961 best val_acc 22.889610
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 450 | val loss 2.1619 val acc 18.2224 best val_acc 22.889610
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 475 | val loss 2.1229 val acc 19.9269 best val_acc 22.889610
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 500 | val loss 2.3442 val acc 9.9635 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 525 | val loss 2.1599 val acc 20.5966 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 550 | val loss 2.4270 val acc 8.4416 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 575 | val loss 2.3042 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 600 | val loss 2.3105 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 625 | val loss 2.3172 val acc 9.7606 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 650 | val loss 2.3025 val acc 10.0852 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 675 | val loss 2.2973 val acc 11.3839 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 700 | val loss 2.3146 val acc 7.5081 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 725 | val loss 2.3032 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 750 | val loss 2.3033 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 775 | val loss 2.3035 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 800 | val loss 2.3037 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 825 | val loss 2.3032 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 850 | val loss 2.3035 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 875 | val loss 2.3038 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 900 | val loss 2.3043 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 925 | val loss 2.3033 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 950 | val loss 2.3037 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 975 | val loss 2.3042 val acc 9.6185 best val_acc 22.991071
New learnin rate  0.25
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 1000 | val loss 2.3040 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 1025 | val loss 2.3033 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 1050 | val loss 2.3035 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 1075 | val loss 2.3037 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 1100 | val loss 2.3041 val acc 9.6794 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 1125 | val loss 2.3004 val acc 10.6128 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 1150 | val loss 2.3823 val acc 9.7403 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 1175 | val loss 2.3039 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 1199 | val loss 2.3039 val acc 9.6185 best val_acc 22.991071
krum: at our_attack_min_eigenvalue n_at 15 n_mal_sel 1 e 1200 | val loss 2.3044 val acc 9.6185 best val_acc 22.991071
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 0 | val loss 2.3023 val acc 10.6737 best val_acc 10.673701
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 25 | val loss 2.2899 val acc 14.0219 best val_acc 18.607955
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 50 | val loss 2.3047 val acc 10.0244 best val_acc 19.521104
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 75 | val loss 2.2488 val acc 17.4310 best val_acc 19.521104
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 100 | val loss 2.2182 val acc 16.7614 best val_acc 19.521104
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 13 e 125 | val loss 2.3302 val acc 11.4245 best val_acc 19.521104
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 150 | val loss 2.2138 val acc 14.6104 best val_acc 20.150162
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 14 e 175 | val loss 2.2838 val acc 11.5666 best val_acc 20.312500
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 200 | val loss 2.2138 val acc 16.6193 best val_acc 20.312500
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 225 | val loss 2.2693 val acc 12.6218 best val_acc 20.312500
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 250 | val loss 2.3702 val acc 13.6972 best val_acc 20.312500
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 275 | val loss 2.1988 val acc 15.3003 best val_acc 20.373377
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 300 | val loss 2.0313 val acc 21.6721 best val_acc 21.672078
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 325 | val loss 2.2636 val acc 12.2362 best val_acc 22.950487
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 350 | val loss 2.2707 val acc 16.8831 best val_acc 22.950487
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 375 | val loss 2.1623 val acc 20.0487 best val_acc 22.950487
Bulyan: at our_attack_min_eigenvalue n_at 15 n_mal_sel 15 e 400 | val loss 2.1041 val acc 19.1761 best val_acc 22.950487
val loss 31816.506849 too high
change new seed now epoch: 419
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Median: at our_attack_min_eigenvalue n_at 15  e 0 | val loss 2.3023 val acc 10.7346 best val_acc 10.734578
Median: at our_attack_min_eigenvalue n_at 15  e 25 | val loss 2.3482 val acc 9.7403 best val_acc 20.819805
Median: at our_attack_min_eigenvalue n_at 15  e 50 | val loss 2.2611 val acc 15.4830 best val_acc 20.819805
Median: at our_attack_min_eigenvalue n_at 15  e 75 | val loss 2.2683 val acc 11.5463 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 100 | val loss 2.2803 val acc 16.0511 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 125 | val loss 2.2764 val acc 11.4651 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 150 | val loss 2.3151 val acc 10.2881 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 175 | val loss 2.3038 val acc 9.7403 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 200 | val loss 2.3030 val acc 9.7403 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 225 | val loss 2.3028 val acc 9.5982 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 250 | val loss 2.3028 val acc 9.8417 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 275 | val loss 2.3028 val acc 9.9026 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 300 | val loss 2.3028 val acc 9.7403 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 325 | val loss 2.3047 val acc 10.2881 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 350 | val loss 2.3841 val acc 13.5349 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 375 | val loss 2.2868 val acc 12.2362 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 400 | val loss 2.2665 val acc 14.3060 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 425 | val loss 2.1543 val acc 17.4310 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 450 | val loss 2.2074 val acc 17.5528 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 475 | val loss 2.2658 val acc 12.5000 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 500 | val loss 2.2813 val acc 9.0300 best val_acc 21.915584
Median: at our_attack_min_eigenvalue n_at 15  e 525 | val loss 2.1655 val acc 22.0982 best val_acc 22.098214
Median: at our_attack_min_eigenvalue n_at 15  e 550 | val loss 2.2329 val acc 15.9903 best val_acc 22.098214
Median: at our_attack_min_eigenvalue n_at 15  e 575 | val loss 2.4885 val acc 10.0244 best val_acc 22.098214
Median: at our_attack_min_eigenvalue n_at 15  e 600 | val loss 2.2885 val acc 14.9148 best val_acc 22.098214
Median: at our_attack_min_eigenvalue n_at 15  e 625 | val loss 2.3050 val acc 12.2362 best val_acc 22.098214
Median: at our_attack_min_eigenvalue n_at 15  e 650 | val loss 2.3098 val acc 15.9091 best val_acc 22.098214
Median: at our_attack_min_eigenvalue n_at 15  e 675 | val loss 2.3096 val acc 7.6907 best val_acc 22.098214
Median: at our_attack_min_eigenvalue n_at 15  e 700 | val loss 2.2230 val acc 16.0714 best val_acc 22.098214
Median: at our_attack_min_eigenvalue n_at 15  e 725 | val loss 2.2261 val acc 12.6015 best val_acc 22.098214
Median: at our_attack_min_eigenvalue n_at 15  e 750 | val loss 2.0779 val acc 17.9586 best val_acc 22.098214
Median: at our_attack_min_eigenvalue n_at 15  e 775 | val loss 2.2153 val acc 16.1526 best val_acc 22.767857
Median: at our_attack_min_eigenvalue n_at 15  e 800 | val loss 2.0864 val acc 19.4805 best val_acc 22.767857
Median: at our_attack_min_eigenvalue n_at 15  e 825 | val loss 2.3705 val acc 9.9229 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 850 | val loss 2.3247 val acc 12.3985 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 875 | val loss 2.3061 val acc 12.7638 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 900 | val loss 2.1264 val acc 21.7735 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 925 | val loss 2.1824 val acc 18.1818 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 950 | val loss 2.3365 val acc 9.8620 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 975 | val loss 2.3026 val acc 9.7606 best val_acc 23.031656
New learnin rate  0.25
Median: at our_attack_min_eigenvalue n_at 15  e 1000 | val loss 2.3026 val acc 9.7606 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 1025 | val loss 2.2967 val acc 10.0649 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 1050 | val loss 2.3069 val acc 9.9229 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 1075 | val loss 2.3018 val acc 11.0998 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 1100 | val loss 2.3030 val acc 9.5982 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 1125 | val loss 2.3029 val acc 9.8214 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 1150 | val loss 2.2749 val acc 13.5552 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 1175 | val loss 2.2460 val acc 13.1899 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 1199 | val loss 2.2215 val acc 15.5641 best val_acc 23.031656
Median: at our_attack_min_eigenvalue n_at 15  e 1200 | val loss 2.2024 val acc 15.6656 best val_acc 23.031656
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
tr_mean: at our_attack_min_eigenvalue n_at 15  e 0 | val loss 2.3023 val acc 10.8360 best val_acc 10.836039
tr_mean: at our_attack_min_eigenvalue n_at 15  e 25 | val loss 2.2988 val acc 10.2881 best val_acc 20.779221
tr_mean: at our_attack_min_eigenvalue n_at 15  e 50 | val loss 2.3035 val acc 10.5722 best val_acc 20.779221
tr_mean: at our_attack_min_eigenvalue n_at 15  e 75 | val loss 2.2687 val acc 12.0739 best val_acc 20.779221
tr_mean: at our_attack_min_eigenvalue n_at 15  e 100 | val loss 2.2618 val acc 13.7175 best val_acc 22.828734
tr_mean: at our_attack_min_eigenvalue n_at 15  e 125 | val loss 2.1192 val acc 19.3791 best val_acc 22.828734
tr_mean: at our_attack_min_eigenvalue n_at 15  e 150 | val loss 2.2025 val acc 17.7760 best val_acc 22.828734
tr_mean: at our_attack_min_eigenvalue n_at 15  e 175 | val loss 2.1909 val acc 16.8222 best val_acc 22.828734
tr_mean: at our_attack_min_eigenvalue n_at 15  e 200 | val loss 2.0718 val acc 18.9123 best val_acc 22.828734
tr_mean: at our_attack_min_eigenvalue n_at 15  e 225 | val loss 2.4324 val acc 10.2476 best val_acc 22.828734
tr_mean: at our_attack_min_eigenvalue n_at 15  e 250 | val loss 2.2809 val acc 9.5982 best val_acc 22.828734
tr_mean: at our_attack_min_eigenvalue n_at 15  e 275 | val loss 1.9814 val acc 19.1558 best val_acc 22.828734
tr_mean: at our_attack_min_eigenvalue n_at 15  e 300 | val loss 2.0088 val acc 17.5528 best val_acc 23.092532
tr_mean: at our_attack_min_eigenvalue n_at 15  e 325 | val loss 2.1653 val acc 17.0455 best val_acc 25.933442
tr_mean: at our_attack_min_eigenvalue n_at 15  e 350 | val loss 1.9149 val acc 21.7938 best val_acc 25.933442
tr_mean: at our_attack_min_eigenvalue n_at 15  e 375 | val loss 2.0760 val acc 19.8661 best val_acc 25.933442
tr_mean: at our_attack_min_eigenvalue n_at 15  e 400 | val loss 2.3023 val acc 10.4099 best val_acc 27.556818
tr_mean: at our_attack_min_eigenvalue n_at 15  e 425 | val loss 2.0286 val acc 22.0373 best val_acc 28.733766
tr_mean: at our_attack_min_eigenvalue n_at 15  e 450 | val loss 3.0825 val acc 10.6331 best val_acc 28.733766
tr_mean: at our_attack_min_eigenvalue n_at 15  e 475 | val loss 2.3004 val acc 12.3174 best val_acc 28.733766
tr_mean: at our_attack_min_eigenvalue n_at 15  e 500 | val loss 2.2912 val acc 12.3377 best val_acc 28.733766
tr_mean: at our_attack_min_eigenvalue n_at 15  e 525 | val loss 2.1019 val acc 21.7330 best val_acc 28.733766
tr_mean: at our_attack_min_eigenvalue n_at 15  e 550 | val loss 1.9348 val acc 23.7622 best val_acc 28.733766
tr_mean: at our_attack_min_eigenvalue n_at 15  e 575 | val loss 1.9651 val acc 24.0057 best val_acc 28.733766
tr_mean: at our_attack_min_eigenvalue n_at 15  e 600 | val loss 2.1995 val acc 16.3352 best val_acc 32.426948
tr_mean: at our_attack_min_eigenvalue n_at 15  e 625 | val loss 2.0759 val acc 17.8977 best val_acc 32.426948
tr_mean: at our_attack_min_eigenvalue n_at 15  e 650 | val loss 2.3266 val acc 16.4976 best val_acc 32.426948
tr_mean: at our_attack_min_eigenvalue n_at 15  e 675 | val loss 2.1829 val acc 17.8774 best val_acc 32.426948
tr_mean: at our_attack_min_eigenvalue n_at 15  e 700 | val loss 2.0268 val acc 24.8174 best val_acc 32.426948
tr_mean: at our_attack_min_eigenvalue n_at 15  e 725 | val loss 1.9017 val acc 25.9537 best val_acc 32.426948
tr_mean: at our_attack_min_eigenvalue n_at 15  e 750 | val loss 2.0891 val acc 21.6315 best val_acc 32.426948
tr_mean: at our_attack_min_eigenvalue n_at 15  e 775 | val loss 2.1603 val acc 21.6315 best val_acc 32.426948
tr_mean: at our_attack_min_eigenvalue n_at 15  e 800 | val loss 2.2278 val acc 16.5179 best val_acc 32.426948
tr_mean: at our_attack_min_eigenvalue n_at 15  e 825 | val loss 2.3519 val acc 24.2289 best val_acc 32.426948
tr_mean: at our_attack_min_eigenvalue n_at 15  e 850 | val loss 2.0789 val acc 22.7476 best val_acc 32.426948
tr_mean: at our_attack_min_eigenvalue n_at 15  e 875 | val loss 5.9459 val acc 9.4359 best val_acc 32.913961
val loss 7336.734977 too high
change new seed now epoch: 879
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
FedAvg: at our_attack_min_eigenvalue n_at 15  e 0 | val loss 2.3023 val acc 11.3231 best val_acc 11.323052
FedAvg: at our_attack_min_eigenvalue n_at 15  e 25 | val loss 2.3059 val acc 9.7808 best val_acc 19.541396
FedAvg: at our_attack_min_eigenvalue n_at 15  e 50 | val loss 2.2704 val acc 16.1120 best val_acc 19.541396
FedAvg: at our_attack_min_eigenvalue n_at 15  e 75 | val loss 2.1170 val acc 20.4343 best val_acc 20.474838
FedAvg: at our_attack_min_eigenvalue n_at 15  e 100 | val loss 2.0511 val acc 25.5885 best val_acc 25.588474
FedAvg: at our_attack_min_eigenvalue n_at 15  e 125 | val loss 2.2748 val acc 12.9667 best val_acc 25.588474
FedAvg: at our_attack_min_eigenvalue n_at 15  e 150 | val loss 2.0257 val acc 22.9099 best val_acc 25.588474
FedAvg: at our_attack_min_eigenvalue n_at 15  e 175 | val loss 1.9737 val acc 25.5479 best val_acc 26.176948
FedAvg: at our_attack_min_eigenvalue n_at 15  e 200 | val loss 2.0287 val acc 27.3133 best val_acc 29.991883
FedAvg: at our_attack_min_eigenvalue n_at 15  e 225 | val loss 1.9958 val acc 23.9651 best val_acc 32.670455
FedAvg: at our_attack_min_eigenvalue n_at 15  e 250 | val loss 1.9450 val acc 27.8003 best val_acc 34.090909
FedAvg: at our_attack_min_eigenvalue n_at 15  e 275 | val loss 1.7494 val acc 34.6388 best val_acc 34.638799
FedAvg: at our_attack_min_eigenvalue n_at 15  e 300 | val loss 1.9704 val acc 26.2378 best val_acc 34.638799
FedAvg: at our_attack_min_eigenvalue n_at 15  e 325 | val loss 1.8720 val acc 29.8093 best val_acc 36.749188
FedAvg: at our_attack_min_eigenvalue n_at 15  e 350 | val loss 1.9284 val acc 30.9456 best val_acc 36.749188
FedAvg: at our_attack_min_eigenvalue n_at 15  e 375 | val loss 1.7898 val acc 34.3344 best val_acc 37.581169
FedAvg: at our_attack_min_eigenvalue n_at 15  e 400 | val loss 1.7167 val acc 38.7581 best val_acc 42.512175
FedAvg: at our_attack_min_eigenvalue n_at 15  e 425 | val loss 2.0628 val acc 23.4781 best val_acc 42.512175
FedAvg: at our_attack_min_eigenvalue n_at 15  e 450 | val loss 1.8529 val acc 32.2037 best val_acc 42.512175
FedAvg: at our_attack_min_eigenvalue n_at 15  e 475 | val loss 1.6351 val acc 42.2484 best val_acc 42.613636
FedAvg: at our_attack_min_eigenvalue n_at 15  e 500 | val loss 1.5174 val acc 46.1445 best val_acc 46.144481
FedAvg: at our_attack_min_eigenvalue n_at 15  e 525 | val loss 1.8386 val acc 35.0041 best val_acc 46.144481
FedAvg: at our_attack_min_eigenvalue n_at 15  e 550 | val loss 2.1362 val acc 27.6786 best val_acc 46.144481
FedAvg: at our_attack_min_eigenvalue n_at 15  e 575 | val loss 2.3321 val acc 12.2971 best val_acc 46.144481
FedAvg: at our_attack_min_eigenvalue n_at 15  e 600 | val loss 1.6774 val acc 38.3523 best val_acc 46.144481
FedAvg: at our_attack_min_eigenvalue n_at 15  e 625 | val loss 1.8048 val acc 36.2622 best val_acc 46.144481
FedAvg: at our_attack_min_eigenvalue n_at 15  e 650 | val loss 1.5240 val acc 46.7127 best val_acc 47.057630
FedAvg: at our_attack_min_eigenvalue n_at 15  e 675 | val loss 1.5664 val acc 42.8369 best val_acc 47.970779
FedAvg: at our_attack_min_eigenvalue n_at 15  e 700 | val loss 1.6889 val acc 40.8888 best val_acc 47.970779
FedAvg: at our_attack_min_eigenvalue n_at 15  e 725 | val loss 2.0848 val acc 28.7946 best val_acc 48.660714
FedAvg: at our_attack_min_eigenvalue n_at 15  e 750 | val loss 1.6006 val acc 41.8628 best val_acc 49.249188
FedAvg: at our_attack_min_eigenvalue n_at 15  e 775 | val loss 1.5136 val acc 46.9562 best val_acc 49.249188
FedAvg: at our_attack_min_eigenvalue n_at 15  e 800 | val loss 2.2265 val acc 17.0252 best val_acc 49.249188
FedAvg: at our_attack_min_eigenvalue n_at 15  e 825 | val loss 2.0100 val acc 28.6729 best val_acc 49.249188
val loss 1215.458686 too high
change new seed now epoch: 846
now use seed: 42
Files already downloaded and verified
Files already downloaded and verified
total data len:  60000
total data len:  60000
total tr len 50000 | val len 5000 | test len 5000
user 0 tr len 1000
user 1 tr len 1000
user 2 tr len 1000
user 3 tr len 1000
user 4 tr len 1000
user 5 tr len 1000
user 6 tr len 1000
user 7 tr len 1000
user 8 tr len 1000
user 9 tr len 1000
user 10 tr len 1000
user 11 tr len 1000
user 12 tr len 1000
user 13 tr len 1000
user 14 tr len 1000
user 15 tr len 1000
user 16 tr len 1000
user 17 tr len 1000
user 18 tr len 1000
user 19 tr len 1000
user 20 tr len 1000
user 21 tr len 1000
user 22 tr len 1000
user 23 tr len 1000
user 24 tr len 1000
user 25 tr len 1000
user 26 tr len 1000
user 27 tr len 1000
user 28 tr len 1000
user 29 tr len 1000
user 30 tr len 1000
user 31 tr len 1000
user 32 tr len 1000
user 33 tr len 1000
user 34 tr len 1000
user 35 tr len 1000
user 36 tr len 1000
user 37 tr len 1000
user 38 tr len 1000
user 39 tr len 1000
user 40 tr len 1000
user 41 tr len 1000
user 42 tr len 1000
user 43 tr len 1000
user 44 tr len 1000
user 45 tr len 1000
user 46 tr len 1000
user 47 tr len 1000
user 48 tr len 1000
user 49 tr len 1000
/home/yunlong/NDSS21-Model-Poisoning/cifar10/sgd.py:109: UserWarning: This overload of add_ is deprecated:
	add_(Number alpha, Tensor other)
Consider using one of the following signatures instead:
	add_(Tensor other, *, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1630.)
  p.data.add_(-group['lr'], d_p)
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 0 | val loss 2.3023 val acc 11.1607 best val_acc 11.160714
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 25 | val loss 2.1739 val acc 20.8807 best val_acc 22.341721
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 50 | val loss 2.2942 val acc 13.5349 best val_acc 22.341721
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 75 | val loss 2.1994 val acc 16.8425 best val_acc 22.341721
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 100 | val loss 2.1197 val acc 19.3182 best val_acc 22.341721
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 125 | val loss 2.2809 val acc 11.2216 best val_acc 22.686688
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 150 | val loss 2.0705 val acc 20.6169 best val_acc 22.686688
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 175 | val loss 1.9871 val acc 24.6753 best val_acc 24.675325
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 200 | val loss 2.1136 val acc 17.9586 best val_acc 25.689935
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 225 | val loss 1.9733 val acc 26.9278 best val_acc 28.185877
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 250 | val loss 1.9036 val acc 26.4610 best val_acc 30.722403
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 275 | val loss 1.8980 val acc 26.7654 best val_acc 31.676136
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 300 | val loss 2.1036 val acc 23.7825 best val_acc 32.832792
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 325 | val loss 2.1757 val acc 17.6136 best val_acc 36.343344
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 350 | val loss 1.7322 val acc 36.3433 best val_acc 36.343344
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 375 | val loss 1.8703 val acc 33.4213 best val_acc 38.758117
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 400 | val loss 1.7532 val acc 36.3028 best val_acc 38.758117
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 425 | val loss 2.1054 val acc 21.1039 best val_acc 40.868506
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 450 | val loss 1.9230 val acc 28.9367 best val_acc 40.949675
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 475 | val loss 1.6639 val acc 38.9610 best val_acc 41.396104
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 500 | val loss 2.1865 val acc 16.7411 best val_acc 41.396104
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 525 | val loss 1.6262 val acc 39.2045 best val_acc 41.396104
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 550 | val loss 1.9287 val acc 33.5836 best val_acc 44.744318
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 575 | val loss 1.6541 val acc 40.4221 best val_acc 46.002435
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 600 | val loss 1.8166 val acc 32.0211 best val_acc 46.002435
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 625 | val loss 1.8485 val acc 28.1859 best val_acc 46.002435
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 650 | val loss 1.7456 val acc 37.1144 best val_acc 46.002435
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 675 | val loss 1.6327 val acc 42.6136 best val_acc 46.002435
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 700 | val loss 1.5096 val acc 47.3823 best val_acc 47.382305
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 725 | val loss 2.1026 val acc 32.8734 best val_acc 47.483766
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 750 | val loss 1.5665 val acc 44.8458 best val_acc 47.706981
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 775 | val loss 1.5571 val acc 44.3791 best val_acc 48.457792
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 800 | val loss 1.5419 val acc 44.9472 best val_acc 50.405844
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 825 | val loss 2.3823 val acc 8.8880 best val_acc 50.507305
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 850 | val loss 1.9020 val acc 30.2557 best val_acc 50.507305
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 875 | val loss 1.7490 val acc 39.0828 best val_acc 50.507305
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 900 | val loss 1.5432 val acc 43.6891 best val_acc 50.507305
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 925 | val loss 1.6283 val acc 40.9294 best val_acc 50.507305
Norm_bounding: at our_attack_min_eigenvalue n_at 15  e 950 | val loss 2.0026 val acc 20.5560 best val_acc 50.872565
val loss 60835.070211 too high
change new seed now epoch: 959
                  Attack Type        Defense  ...  Best Global Accuracy  epoch_num
0       our_attack_cos_second         Bulyan  ...             54.241071       1201
1       our_attack_cos_second         Bulyan  ...             22.179383         67
2       our_attack_cos_second         Bulyan  ...             21.387987        455
3       our_attack_cos_second         FedAvg  ...             57.568994       1201
4       our_attack_cos_second         FedAvg  ...             34.090909        855
5       our_attack_cos_second         FedAvg  ...             32.670455       1201
6       our_attack_cos_second         Median  ...             51.582792        914
7       our_attack_cos_second         Median  ...             33.340097       1201
8       our_attack_cos_second         Median  ...             22.585227        970
9       our_attack_cos_second     Multi_krum  ...             59.821429       1201
10      our_attack_cos_second     Multi_krum  ...             42.146916       1201
11      our_attack_cos_second     Multi_krum  ...             26.116071       1201
12      our_attack_cos_second  Norm_bounding  ...             55.844156        777
13      our_attack_cos_second  Norm_bounding  ...             35.653409        778
14      our_attack_cos_second  Norm_bounding  ...             31.676136       1201
15      our_attack_cos_second           krum  ...             52.191558       1201
16      our_attack_cos_second           krum  ...             25.365260       1201
17      our_attack_cos_second           krum  ...             21.793831       1201
18      our_attack_cos_second        tr_mean  ...             43.709416        511
19      our_attack_cos_second        tr_mean  ...             29.809253        842
20      our_attack_cos_second        tr_mean  ...             23.092532       1201
21  our_attack_min_eigenvalue         Bulyan  ...             51.400162        903
22  our_attack_min_eigenvalue         Bulyan  ...             21.956169        132
23  our_attack_min_eigenvalue         Bulyan  ...             22.950487        419
24  our_attack_min_eigenvalue         FedAvg  ...             64.001623       1201
25  our_attack_min_eigenvalue         FedAvg  ...             57.873377       1201
26  our_attack_min_eigenvalue         FedAvg  ...             49.249188        846
27  our_attack_min_eigenvalue         Median  ...             53.530844        986
28  our_attack_min_eigenvalue         Median  ...             35.267857       1201
29  our_attack_min_eigenvalue         Median  ...             23.031656       1201
30  our_attack_min_eigenvalue     Multi_krum  ...             64.671266       1201
31  our_attack_min_eigenvalue     Multi_krum  ...             46.205357        740
32  our_attack_min_eigenvalue     Multi_krum  ...             25.771104       1201
33  our_attack_min_eigenvalue  Norm_bounding  ...             63.534903       1201
34  our_attack_min_eigenvalue  Norm_bounding  ...             51.846591        943
35  our_attack_min_eigenvalue  Norm_bounding  ...             50.872565        959
36  our_attack_min_eigenvalue           krum  ...             31.818182        918
37  our_attack_min_eigenvalue           krum  ...             22.686688        179
38  our_attack_min_eigenvalue           krum  ...             22.991071       1201
39  our_attack_min_eigenvalue        tr_mean  ...             65.178571       1201
40  our_attack_min_eigenvalue        tr_mean  ...             54.728084       1201
41  our_attack_min_eigenvalue        tr_mean  ...             32.913961        879

[42 rows x 7 columns]
Experiment Finished Successfully
